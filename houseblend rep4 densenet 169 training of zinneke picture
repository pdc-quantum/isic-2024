{"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","provenance":[{"file_id":"1NQUaub4W12nCMg5n-WsacO0D77dvXckv","timestamp":1724381970722},{"file_id":"1kgShMso2QgXf-5MhrHxSN2Jx86BlLK7v","timestamp":1724310293577},{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/zinneke-picture-7dd8d4ea-01ff-419b-b2cd-d867d8d1d03f.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20240811/auto/storage/goog4_request&X-Goog-Date=20240811T064721Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=53befc0568abf4b053465fdd0f09102daab4f43023a458d24b821ddc887dc7d96d0335a3c9c20f9d0c6c2031b8720070884b6a05c8045fd2df0540bcc40fc87453955bb665195119d289cea97cfc306e02f7ae391235b245530d8ee691658eb716c8c0cfbcdae32a84e99fa5f6b82a1c2e5f40e54df5c16ecb63f70411d9f1d0347caf26a03544b91afb9879e0b73c33addf2fe74dae0cfac503918408794cfa28769517bb4a1ca0a5b1fcd116e86318f3dcecbe370183407837a4dec0de31985e2fe2a5e094ce42e3d69ae415c2386d70ec21740b38203255ae8eb51f073b6698e4bec74c115ca4e8d6c0bee2432eec7697ff7675aa1833afbf0434e8ea1ec8","timestamp":1723358850760},{"file_id":"1G-FZ6NdOU-xVp7o4AQfrDByh60FsPqXU","timestamp":1722374812038},{"file_id":"https://storage.googleapis.com/kaggle-colab-exported-notebooks/isic-2024-pytorch-training-effnet-b2-42f84861-6799-446a-b569-822d6e5a4149.ipynb?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com/20240726/auto/storage/goog4_request&X-Goog-Date=20240726T203743Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=02dda529bc77d43d996e66896c3bc2cfefad4ad73aee9b39d330ae1aa92c61fb00c0d33a1c469e59670d91594ef9acc31d55a18ede693a15a70633449660685bc0a86b7fbffd3978b9ed754f6a3a54e254ff21f501e3670ab298c1c18ddfc13a3640f44c340db11518a456632837fa4f37bf6bfa44111e0efbec927105fd5396d35965571fb7c83b6c0ddd79ac0ee389d058f93fac19e1f7961430df12083c932240b96caa0032a3f45ef8966b75731821ebb94b92c776b6ccc0af82d32fee00dcc9abe37e7aa23b73117d8db04606de97e89684585fca6c932d9d550a5eca820b4f15459bea44c9f58d95a603b608c47d57ac611289d4c372fdd4e384e3bad4","timestamp":1722026331852}]},"kaggle":{"accelerator":"none","dataSources":[{"sourceId":63056,"databundleVersionId":9094797,"sourceType":"competition"},{"sourceId":8805041,"sourceType":"datasetVersion","datasetId":5295511},{"sourceId":8805074,"sourceType":"datasetVersion","datasetId":5295526},{"sourceId":8805104,"sourceType":"datasetVersion","datasetId":5295545},{"sourceId":9118579,"sourceType":"datasetVersion","datasetId":5504311},{"sourceId":9144856,"sourceType":"datasetVersion","datasetId":5523470},{"sourceId":9146933,"sourceType":"datasetVersion","datasetId":5525007},{"sourceId":3732,"sourceType":"modelInstanceVersion","modelInstanceId":2659,"modelId":312},{"sourceId":92232,"sourceType":"modelInstanceVersion","isSourceIdPinned":true,"modelInstanceId":77322,"modelId":101954}],"dockerImageVersionId":30747,"isInternetEnabled":false,"language":"python","sourceType":"notebook","isGpuEnabled":false},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":4653.084709,"end_time":"2024-08-08T06:30:12.536858","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-08-08T05:12:39.452149","version":"2.5.0"},"widgets":{"application/vnd.jupyter.widget-state+json":{"29d822209ecd452586238d8bd055a70d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f866f96700aa4435bfcf9e56ef314ff4","IPY_MODEL_850704eef6ba478789bf296c6b131868","IPY_MODEL_4386375f1a6648b89900950cb01e87f8"],"layout":"IPY_MODEL_f6af7986750941c2b093234b0e5cccc2"}},"f866f96700aa4435bfcf9e56ef314ff4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c92e6cf16dc44773be92c30fceb4603c","placeholder":"​","style":"IPY_MODEL_389dde8eb8344ba9800ef335d49ab646","value":"model.safetensors: 100%"}},"850704eef6ba478789bf296c6b131868":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2ef4415a899a4bcfa3b842d2874ffbc5","max":57350342,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f4cdab05b9aa4b9ca9c786ba467bb9e5","value":57350342}},"4386375f1a6648b89900950cb01e87f8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_093f456daf4147a097381ab39d1e2744","placeholder":"​","style":"IPY_MODEL_77e4058a35904e328dbd9abae31d4d33","value":" 57.4M/57.4M [00:00&lt;00:00, 139MB/s]"}},"f6af7986750941c2b093234b0e5cccc2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c92e6cf16dc44773be92c30fceb4603c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"389dde8eb8344ba9800ef335d49ab646":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2ef4415a899a4bcfa3b842d2874ffbc5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f4cdab05b9aa4b9ca9c786ba467bb9e5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"093f456daf4147a097381ab39d1e2744":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"77e4058a35904e328dbd9abae31d4d33":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat_minor":0,"nbformat":4,"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"ilRhTTgaX4OE","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724447077010,"user_tz":-120,"elapsed":2210,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"cbf244c2-d516-484e-e4e5-b01626aef8d1"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["# for colab\n","from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5hzXdHCFPrFV"},"outputs":[],"source":["#path_isic_data = '/content/drive/MyDrive/Data/ISIC-2018/dup1-output-zinneke-picture-train-d169/'\n","path_isic_data = '/content/drive/MyDrive/Data/ISIC-2018/houseblend-rep4-output-zinneke-picture-train-d169/'"]},{"source":["\n","# IMPORTANT: RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES\n","# TO THE CORRECT LOCATION (/kaggle/input) IN YOUR NOTEBOOK,\n","# THEN FEEL FREE TO DELETE THIS CELL.\n","# NOTE: THIS NOTEBOOK ENVIRONMENT DIFFERS FROM KAGGLE'S PYTHON\n","# ENVIRONMENT SO THERE MAY BE MISSING LIBRARIES USED BY YOUR\n","# NOTEBOOK.\n","\n","import os\n","import sys\n","from tempfile import NamedTemporaryFile\n","from urllib.request import urlopen\n","from urllib.parse import unquote, urlparse\n","from urllib.error import HTTPError\n","from zipfile import ZipFile\n","import tarfile\n","import shutil\n","\n","CHUNK_SIZE = 40960\n","DATA_SOURCE_MAPPING = 'isic-2024-challenge:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-competitions-data%2Fkaggle-v2%2F63056%2F9094797%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240822%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240822T093913Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D4968c298871e3fd63bd40ba7189c74f715552cf58c341cef1f82b95c2ac6f65ad943fd2521b6f3f791c4648d3ea626f3a0f67518c86f0ed8c5551a3658e64cac16fa76fb1a2f08a655660982e59c4433e30b5f0fea6f9f6c80993bf3af742ee303dd72b71c5a53cc9593926fd50778547af1e047045207d8aed006fd36f3044778dd9bd3537f5d577660b75cc267c251a4e2a341ff92463007bf87821678f1d4f53a8a4c9798977d0d949bf0a0c078c907384f2c8b3a50135f594bf1dd7d6f7c4e6ccd15c3f17e5507bd13cb4dd8e920b746e209116c5cf4567f5c4a5864f6c59a2dae8fead78f82e4b8dd46bf40d473014245066be365a34e7b8f4136616f6c,isic-2018-jpg-256x256-resized:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F5295511%2F8805041%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240822%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240822T093913Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D8b9598754a4c93ccd4f09e9f336aa8b0a3fca7dac7cf9a4a85dabbcd75610a601fa9a33420c3b3d6f76b31e48f83b44d76e6895407c3e4a4bdf004a06765a3d0de724ef5a8adba8908614138d8772f89017a9f721c55ba302f53cdbe2f9b26073f2b272a113d03fe89dadce146c67a35ab77a701099dad37463c09ebedf5fbe71facfa943fc9a23e59613d4aa0605b7714f3cf88bd202bbf4d653b91db5519cc174de38ae416077f3c6bd9a1bcc560df908f2a4f8bdfd0b0f1ef70a7db9add72e4530f4e4f91808c4047c9a1863c6d3e5edc4f169c8cc057600d096c5f9a17d72452c2ed819506d845aefc2bdb95d6746cc20c915d50eee291ac2597003d30d3,isic-2019-jpg-256x256-resized:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F5295526%2F8805074%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240822%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240822T093914Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D52fc60aaeb7eb941e193f3a4c90c5562532ce42d1b998013423f61a7fb24dfa27b8b25dc04acdbfcddd47ea62c1499470cd818274ff6586e0021755eb5564441ab4767633b922dddf1480b75777242a0ad5c3175e3245b05ab956c7b1c3d6c93ee636f9f686f4ac9634b5e206230242ef731a5d3f6b26bdcfc53f04c5acc189b7048876c69a944a9d23ba2416dabb641c32ab2448343ae5322f8651185bf90f6ee37225a6d0052e23ed66d4a788fe39a41fbb5e4ac48e030e8eea075687aad766ef0390bbe0e3cbe5afb0ba0b5dd713b4f0aab831a22b9a62ccc3a26d736176632dd94256a067e359fdd1e60d37cbe49d6a3bababa2a9f9728b07da2dda44e22,isic-2020-jpg-256x256-resized:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F5295545%2F8805104%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240822%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240822T093914Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D3995a0bef3f311b63bbb6afb52cda4601c2d26410574cc060506b6e56723862f38bd8b95609378a912c9ec0e66c8c1bed95d3deaf2bc137cc21ea4919514881d886355118256229f6b395be522bdd42aed95350154a993144d7ea01bce80f84e744cf4837561215b7d9ab95a0201c4747911f8bd78ba506560d805c03e4b979753fad1a97f0b04c0005412a9d59e1ebac3cf57d5f3120440224b700c569aad32411ea7a52a8f5191ee2682be512a02fbcd8d2ebdafe6e2b9451cba2ac39c7dbe41736d23d528e597775721666be90228be057a8fe99d1f5bb39ad8602dc7eeb0829823630c6665757c947e8336dac67c0fa2886b0fe3b5a23ed27f2fa9a9bf9b,tf-efficientnet/pytorch/tf-efficientnet-b3/1:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-models-data%2F2659%2F3732%2Fbundle%2Farchive.tar.gz%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240822%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240822T093914Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D26a6848c01e967dd1a9cb27d33985ab431325ccfe9d50de9fd4488753b818a1e7cf04f998815b277ac8d7c2d75d37dae1398cd3f519c2f8d8205641eb45133bdbb0b1c491ba3d9a9d9b5325fc478f436dfaf8e60b92ff131dc644012d93052bfe193822ab1f2342ed9528955c4a92d6ca35c35a10fb796f199412683017be3c9a4b6b983b7477bef32edd41cfc6c99e6fbc9c937cd51105b19025862e64d6e9a365cc17df84e0033f3156b1460301e270a76dd54f43c1c45ac9a1cd573753ba2a01ad1d4a9e9dbd88a653d1db9f0a2482124c95e1766a089b0f2aa6ceca7dff9151b295dcee9b0d59228fa7e78d3fab6ca462ee3bd6a5d0e1f429d7eaf52c8c6'\n","\n","KAGGLE_INPUT_PATH='/kaggle/input'\n","KAGGLE_WORKING_PATH='/kaggle/working'\n","KAGGLE_SYMLINK='kaggle'\n","\n","!umount /kaggle/input/ 2> /dev/null\n","shutil.rmtree('/kaggle/input', ignore_errors=True)\n","os.makedirs(KAGGLE_INPUT_PATH, 0o777, exist_ok=True)\n","os.makedirs(KAGGLE_WORKING_PATH, 0o777, exist_ok=True)\n","\n","try:\n","  os.symlink(KAGGLE_INPUT_PATH, os.path.join(\"..\", 'input'), target_is_directory=True)\n","except FileExistsError:\n","  pass\n","try:\n","  os.symlink(KAGGLE_WORKING_PATH, os.path.join(\"..\", 'working'), target_is_directory=True)\n","except FileExistsError:\n","  pass\n","\n","for data_source_mapping in DATA_SOURCE_MAPPING.split(','):\n","    directory, download_url_encoded = data_source_mapping.split(':')\n","    download_url = unquote(download_url_encoded)\n","    filename = urlparse(download_url).path\n","    destination_path = os.path.join(KAGGLE_INPUT_PATH, directory)\n","    try:\n","        with urlopen(download_url) as fileres, NamedTemporaryFile() as tfile:\n","            total_length = fileres.headers['content-length']\n","            print(f'Downloading {directory}, {total_length} bytes compressed')\n","            dl = 0\n","            data = fileres.read(CHUNK_SIZE)\n","            while len(data) > 0:\n","                dl += len(data)\n","                tfile.write(data)\n","                done = int(50 * dl / int(total_length))\n","                sys.stdout.write(f\"\\r[{'=' * done}{' ' * (50-done)}] {dl} bytes downloaded\")\n","                sys.stdout.flush()\n","                data = fileres.read(CHUNK_SIZE)\n","            if filename.endswith('.zip'):\n","              with ZipFile(tfile) as zfile:\n","                zfile.extractall(destination_path)\n","            else:\n","              with tarfile.open(tfile.name) as tarfile:\n","                tarfile.extractall(destination_path)\n","            print(f'\\nDownloaded and uncompressed: {directory}')\n","    except HTTPError as e:\n","        print(f'Failed to load (likely expired) {download_url} to path {destination_path}')\n","        continue\n","    except OSError as e:\n","        print(f'Failed to load {download_url} to path {destination_path}')\n","        continue\n","\n","print('Data source import complete.')\n"],"metadata":{"id":"G2zp8teZdFl6","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724447568845,"user_tz":-120,"elapsed":321956,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"05847b65-d349-4b67-a37b-9c3a8484bb80"},"cell_type":"code","outputs":[{"output_type":"stream","name":"stdout","text":["Downloading isic-2024-challenge, 2148525604 bytes compressed\n","[==================================================] 2148525604 bytes downloaded\n","Downloaded and uncompressed: isic-2024-challenge\n","Downloading isic-2018-jpg-256x256-resized, 137798195 bytes compressed\n","[==================================================] 137798195 bytes downloaded\n","Downloaded and uncompressed: isic-2018-jpg-256x256-resized\n","Downloading isic-2019-jpg-256x256-resized, 466726618 bytes compressed\n","[==================================================] 466726618 bytes downloaded\n","Downloaded and uncompressed: isic-2019-jpg-256x256-resized\n","Downloading isic-2020-jpg-256x256-resized, 624178238 bytes compressed\n","[==================================================] 624178238 bytes downloaded\n","Downloaded and uncompressed: isic-2020-jpg-256x256-resized\n","Downloading tf-efficientnet/pytorch/tf-efficientnet-b3/1, 45614007 bytes compressed\n","[==================================================] 45614007 bytes downloaded\n","Downloaded and uncompressed: tf-efficientnet/pytorch/tf-efficientnet-b3/1\n","Data source import complete.\n"]}],"execution_count":null},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 40px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px; text-align:center\">Note from the previous coder</h1></span>\n","This note book is forked from [here](https://www.kaggle.com/code/motono0223/isic-pytorch-training-baseline-image-only)\n","\n","Credit:\n","* https://www.kaggle.com/code/samu2505/isic-pytorchmodel-training\n","    * This notebook added images from past ISIC datasets and I used it to enlarge the size of positive cases\n","    \n","Future Improvements:\n","* I used EffNet_b3, and maybe other model could have better performance.\n","* The size of dataset is limited due to the computation power. if you have better machine, you could enlarge the dataset of training.\n","* Parameter finetuning (the epoch = 20 now).\n","* I only one fold out of five, which can be changed.\n","\n","Notebooks:\n","- Training notebook (This Notebook):\n","- [Inference notebook](https://www.kaggle.com/code/hugowjd/isic-2024-pytorch-inference-effnet-b2/)"],"metadata":{"id":"7nD0BWv5w4wX","papermill":{"duration":0.023962,"end_time":"2024-08-08T05:12:42.1117","exception":false,"start_time":"2024-08-08T05:12:42.087738","status":"completed"},"tags":[]}},{"cell_type":"markdown","source":["# Code origin\n","https://www.google.com/url?q=https%3A%2F%2Fwww.kaggle.com%2Fcode%2Fmotono0223%2Fisic-pytorch-training-baseline-image-only\n","\n","Main modification: generate the CVS my-mix-image-small.csv and my-mix-image.csv that will be used for further research."],"metadata":{"papermill":{"duration":0.022599,"end_time":"2024-08-08T05:12:42.159021","exception":false,"start_time":"2024-08-08T05:12:42.136422","status":"completed"},"tags":[],"id":"H0UfPbdDMQwX"}},{"cell_type":"markdown","source":["## <span><h1 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 50px 50px;\">Import Required Libraries</h1></span>"],"metadata":{"id":"YtCrXA2lw4wY","papermill":{"duration":0.022687,"end_time":"2024-08-08T05:25:13.740352","exception":false,"start_time":"2024-08-08T05:25:13.717665","status":"completed"},"tags":[]}},{"cell_type":"code","source":["!pip install timm"],"metadata":{"id":"uCG-wq4HyZFn","papermill":{"duration":12.051659,"end_time":"2024-08-08T05:25:39.549708","exception":false,"start_time":"2024-08-08T05:25:27.498049","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:13:47.600581Z","iopub.execute_input":"2024-08-10T08:13:47.600994Z","iopub.status.idle":"2024-08-10T08:14:24.003603Z","shell.execute_reply.started":"2024-08-10T08:13:47.600962Z","shell.execute_reply":"2024-08-10T08:14:24.002068Z"},"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724447639527,"user_tz":-120,"elapsed":70702,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"6013ffb0-70c1-4aeb-a944-3edc292069c8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting timm\n","  Downloading timm-1.0.8-py3-none-any.whl.metadata (53 kB)\n","\u001b[?25l     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/53.8 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m53.8/53.8 kB\u001b[0m \u001b[31m3.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: torch in /usr/local/lib/python3.10/dist-packages (from timm) (2.3.1+cu121)\n","Requirement already satisfied: torchvision in /usr/local/lib/python3.10/dist-packages (from timm) (0.18.1+cu121)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from timm) (6.0.2)\n","Requirement already satisfied: huggingface_hub in /usr/local/lib/python3.10/dist-packages (from timm) (0.23.5)\n","Requirement already satisfied: safetensors in /usr/local/lib/python3.10/dist-packages (from timm) (0.4.4)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->timm) (3.15.4)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->timm) (2024.6.1)\n","Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->timm) (24.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->timm) (2.32.3)\n","Requirement already satisfied: tqdm>=4.42.1 in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->timm) (4.66.5)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface_hub->timm) (4.12.2)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch->timm) (1.13.2)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch->timm) (3.3)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch->timm) (3.1.4)\n","Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch->timm)\n","  Using cached nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cuda-runtime-cu12==12.1.105 (from torch->timm)\n","  Using cached nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch->timm)\n","  Using cached nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cudnn-cu12==8.9.2.26 (from torch->timm)\n","  Using cached nvidia_cudnn_cu12-8.9.2.26-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cublas-cu12==12.1.3.1 (from torch->timm)\n","  Using cached nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cufft-cu12==11.0.2.54 (from torch->timm)\n","  Using cached nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-curand-cu12==10.3.2.106 (from torch->timm)\n","  Using cached nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch->timm)\n","  Using cached nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch->timm)\n","  Using cached nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-nccl-cu12==2.20.5 (from torch->timm)\n","  Using cached nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl.metadata (1.8 kB)\n","Collecting nvidia-nvtx-cu12==12.1.105 (from torch->timm)\n","  Using cached nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.7 kB)\n","Requirement already satisfied: triton==2.3.1 in /usr/local/lib/python3.10/dist-packages (from torch->timm) (2.3.1)\n","Collecting nvidia-nvjitlink-cu12 (from nvidia-cusolver-cu12==11.4.5.107->torch->timm)\n","  Using cached nvidia_nvjitlink_cu12-12.6.20-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from torchvision->timm) (1.26.4)\n","Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.10/dist-packages (from torchvision->timm) (9.4.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch->timm) (2.1.5)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface_hub->timm) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface_hub->timm) (3.7)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface_hub->timm) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface_hub->timm) (2024.7.4)\n","Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy->torch->timm) (1.3.0)\n","Downloading timm-1.0.8-py3-none-any.whl (2.3 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.3/2.3 MB\u001b[0m \u001b[31m42.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hUsing cached nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)\n","Using cached nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)\n","Using cached nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)\n","Using cached nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)\n","Using cached nvidia_cudnn_cu12-8.9.2.26-py3-none-manylinux1_x86_64.whl (731.7 MB)\n","Using cached nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)\n","Using cached nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)\n","Using cached nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)\n","Using cached nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)\n","Using cached nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)\n","Using cached nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)\n","Using cached nvidia_nvjitlink_cu12-12.6.20-py3-none-manylinux2014_x86_64.whl (19.7 MB)\n","Installing collected packages: nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nvidia-cusolver-cu12, timm\n","Successfully installed nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-8.9.2.26 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.6.20 nvidia-nvtx-cu12-12.1.105 timm-1.0.8\n"]}]},{"cell_type":"code","source":["import os\n","import gc\n","import cv2\n","import math\n","import copy\n","import time\n","import random\n","import glob\n","from pathlib import Path\n","import h5py\n","from PIL import Image\n","from io import BytesIO\n","\n","# For data manipulation\n","import numpy as np\n","import pandas as pd\n","\n","# Pytorch Imports\n","import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","import torch.nn.functional as F\n","from torch.optim import lr_scheduler\n","from torch.utils.data import Dataset, DataLoader\n","from torch.cuda import amp\n","import torchvision\n","#from torcheval.metrics.functional import binary_auroc\n","\n","# Utils\n","import joblib\n","from tqdm import tqdm\n","from collections import defaultdict\n","\n","# Sklearn Imports\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.model_selection import StratifiedKFold, StratifiedGroupKFold, train_test_split\n","from sklearn.metrics import auc, roc_curve\n","\n","# For Image Models\n","import timm\n","\n","# Albumentations for augmentations\n","import albumentations as A\n","from albumentations.pytorch import ToTensorV2\n","\n","# For colored terminal text\n","# from colorama import Fore, Back, Style\n","# b_ = Fore.BLUE\n","# sr_ = Style.RESET_ALL\n","\n","import warnings\n","warnings.filterwarnings(\"ignore\")\n","\n","# For descriptive error messages\n","os.environ['CUDA_LAUNCH_BLOCKING'] = \"1\"\n","\n","# Plot package\n","import PIL\n","\n","from matplotlib import pyplot as plt"],"metadata":{"id":"kTaXjDdMw4wZ","papermill":{"duration":8.951626,"end_time":"2024-08-08T05:25:48.525949","exception":false,"start_time":"2024-08-08T05:25:39.574323","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:24.005893Z","iopub.execute_input":"2024-08-10T08:14:24.006449Z","iopub.status.idle":"2024-08-10T08:14:32.739088Z","shell.execute_reply.started":"2024-08-10T08:14:24.006399Z","shell.execute_reply":"2024-08-10T08:14:32.737791Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 40px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px; text-align:center\">Configuration</h1></span>"],"metadata":{"id":"-o8DZUCPw4wZ","papermill":{"duration":0.023748,"end_time":"2024-08-08T05:25:48.574482","exception":false,"start_time":"2024-08-08T05:25:48.550734","status":"completed"},"tags":[]}},{"cell_type":"code","source":["CONFIG = {\n","    \"seed\": 42,\n","    \"epochs\": 10,\n","    \"img_size\": 224, # for b0 # 288, # was 384,\n","    #\"model_name\": \"tf_efficientnet_b3_ns\",\n","    \"model_name\": \"densenet169.tv_in1k\",\n","    #\"checkpoint_path\" : \"/kaggle/input/tf-efficientnet/pytorch/tf-efficientnet-b3/1/tf_efficientnet_b3_aa-84b4657e.pth\",\n","    #\"checkpoint_path\" : \"/kaggle/input/pdc_efficientnet/pytorch/default/1/tf_efficientnet_b0_aa-827b6e33.pth\",\n","    \"train_batch_size\": 32,\n","    \"valid_batch_size\": 64,\n","    \"learning_rate\": 5e-5,\n","    \"scheduler\": 'CosineAnnealingLR',\n","    \"min_lr\": 5e-7,\n","    \"T_max\": 500,\n","    \"weight_decay\": 1e-6,\n","    \"fold\" : 0,\n","    \"n_fold\": 5,\n","    \"n_accumulate\": 1,\n","    \"replicate_pos\" : 4,\n","    \"target_ratio\" : 4,\n","    \"device\": torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\"),\n","}"],"metadata":{"id":"qpYc_FJuw4wZ","papermill":{"duration":0.111643,"end_time":"2024-08-08T05:25:48.751479","exception":false,"start_time":"2024-08-08T05:25:48.639836","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.74065Z","iopub.execute_input":"2024-08-10T08:14:32.741317Z","iopub.status.idle":"2024-08-10T08:14:32.748966Z","shell.execute_reply.started":"2024-08-10T08:14:32.741281Z","shell.execute_reply":"2024-08-10T08:14:32.747604Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["CONFIG['device']"],"metadata":{"id":"mvWLHjo5w4wa","papermill":{"duration":0.032987,"end_time":"2024-08-08T05:25:48.808791","exception":false,"start_time":"2024-08-08T05:25:48.775804","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.752401Z","iopub.execute_input":"2024-08-10T08:14:32.752802Z","iopub.status.idle":"2024-08-10T08:14:32.769579Z","shell.execute_reply.started":"2024-08-10T08:14:32.752765Z","shell.execute_reply":"2024-08-10T08:14:32.768053Z"},"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724447658849,"user_tz":-120,"elapsed":7,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"3aa678f6-791b-4f14-9675-8cc81dd1301b"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["device(type='cuda', index=0)"]},"metadata":{},"execution_count":12}]},{"cell_type":"markdown","source":["## <span><h2 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 50px 50px;\">Set Seed for Reproducibility</h2></span>"],"metadata":{"id":"h_SBRfZUw4wa","papermill":{"duration":0.024232,"end_time":"2024-08-08T05:25:48.857606","exception":false,"start_time":"2024-08-08T05:25:48.833374","status":"completed"},"tags":[]}},{"cell_type":"code","source":["def set_seed(seed=42):\n","    '''Sets the seed of the entire notebook so results are the same every time we run.\n","    This is for REPRODUCIBILITY.'''\n","    np.random.seed(seed)\n","    if torch.cuda.is_available():\n","        torch.cuda.manual_seed(seed)\n","        torch.cuda.manual_seed_all(seed)\n","        torch.backends.cudnn.deterministic = False\n","        torch.backends.cudnn.benchmark = True\n","    os.environ['PYTHONHASHSEED'] = str(seed)\n","    print(f\"Seeding done ...\")\n","\n","def flush():\n","    gc.collect()\n","    if torch.cuda.is_available():\n","        torch.cuda.empty_cache()\n","        torch.cuda.reset_peak_memory_stats()\n","set_seed(CONFIG['seed'])"],"metadata":{"id":"AYLWOhWOw4wa","papermill":{"duration":0.036861,"end_time":"2024-08-08T05:25:48.918576","exception":false,"start_time":"2024-08-08T05:25:48.881715","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.771413Z","iopub.execute_input":"2024-08-10T08:14:32.77187Z","iopub.status.idle":"2024-08-10T08:14:32.784364Z","shell.execute_reply.started":"2024-08-10T08:14:32.771797Z","shell.execute_reply":"2024-08-10T08:14:32.782879Z"},"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724447658849,"user_tz":-120,"elapsed":5,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"cfbd8a3f-858c-41f9-b208-ea034782cab9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Seeding done ...\n"]}]},{"cell_type":"code","source":["ROOT_DIR = \"/kaggle/input/isic-2024-challenge\"\n","TRAIN_DIR = f'{ROOT_DIR}/train-image/image'\n","TEST_DIR = f'{ROOT_DIR}/test-image.hdf5/image'"],"metadata":{"id":"8PVUViMKw4wb","papermill":{"duration":0.030454,"end_time":"2024-08-08T05:25:48.973101","exception":false,"start_time":"2024-08-08T05:25:48.942647","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.78596Z","iopub.execute_input":"2024-08-10T08:14:32.786652Z","iopub.status.idle":"2024-08-10T08:14:32.800992Z","shell.execute_reply.started":"2024-08-10T08:14:32.786604Z","shell.execute_reply":"2024-08-10T08:14:32.799684Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["TEST_CSV = f'{ROOT_DIR}/test-metadata.csv'\n","TEST_HDF = f'{ROOT_DIR}/test-image.hdf5'\n","SAMPLE = f'{ROOT_DIR}/sample_submission.csv'"],"metadata":{"papermill":{"duration":0.030768,"end_time":"2024-08-08T05:25:49.028068","exception":false,"start_time":"2024-08-08T05:25:48.9973","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.802786Z","iopub.execute_input":"2024-08-10T08:14:32.803317Z","iopub.status.idle":"2024-08-10T08:14:32.813981Z","shell.execute_reply.started":"2024-08-10T08:14:32.803272Z","shell.execute_reply":"2024-08-10T08:14:32.812716Z"},"trusted":true,"id":"j0e1qEAKMQwb"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def get_train_file_path(image_id):\n","    return f\"{TRAIN_DIR}/{image_id}.jpg\""],"metadata":{"id":"b4pt0IQKw4wb","papermill":{"duration":0.030276,"end_time":"2024-08-08T05:25:49.082535","exception":false,"start_time":"2024-08-08T05:25:49.052259","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.815577Z","iopub.execute_input":"2024-08-10T08:14:32.816013Z","iopub.status.idle":"2024-08-10T08:14:32.825882Z","shell.execute_reply.started":"2024-08-10T08:14:32.81598Z","shell.execute_reply":"2024-08-10T08:14:32.824605Z"},"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# not used\n","#def get_test_file_path(image_id):\n","    #return f\"{TEST_DIR}/{image_id}.jpg\""],"metadata":{"papermill":{"duration":0.031644,"end_time":"2024-08-08T05:25:49.138414","exception":false,"start_time":"2024-08-08T05:25:49.10677","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.827332Z","iopub.execute_input":"2024-08-10T08:14:32.827722Z","iopub.status.idle":"2024-08-10T08:14:32.837018Z","shell.execute_reply.started":"2024-08-10T08:14:32.827692Z","shell.execute_reply":"2024-08-10T08:14:32.835572Z"},"trusted":true,"id":"pLnZ_OduMQwb"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <h1 style = \"font-family: garamond; font-size: 40px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px; text-align:center\">Read the Data</h1>"],"metadata":{"id":"C6sfwVEJw4wb","papermill":{"duration":0.024653,"end_time":"2024-08-08T05:25:49.187255","exception":false,"start_time":"2024-08-08T05:25:49.162602","status":"completed"},"tags":[]}},{"cell_type":"code","source":["train_images = sorted(glob.glob(f\"{TRAIN_DIR}/*.jpg\"))"],"metadata":{"id":"CsRI71I9w4wb","papermill":{"duration":1.838038,"end_time":"2024-08-08T05:25:51.049596","exception":false,"start_time":"2024-08-08T05:25:49.211558","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#test_images = sorted(glob.glob(f\"{TEST_DIR}/*.jpg\"))"],"metadata":{"papermill":{"duration":0.031198,"end_time":"2024-08-08T05:25:51.105596","exception":false,"start_time":"2024-08-08T05:25:51.074398","status":"completed"},"tags":[],"trusted":true,"id":"gv9p3frlMQwc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Read past isic competition data\n","check_path = lambda p: os.path.exists(p)\n","\n","# 2020\n","DATA_PATH_2020 = Path(\"/kaggle/input/isic-2020-jpg-256x256-resized\")\n","get_image_path_2020 = lambda p: os.path.join(f'{str(DATA_PATH_2020/\"train-image/image\")}/{p}.jpg')\n","df_train_2020 = pd.read_csv(DATA_PATH_2020/\"train-metadata.csv\")\n","df_positive_2020 = df_train_2020[df_train_2020[\"target\"] == 1].reset_index(drop=True)\n","df_positive_2020['file_path'] = df_positive_2020[\"isic_id\"].apply(get_image_path_2020)\n","df_positive_2020['exists'] = df_positive_2020['file_path'].apply(check_path)\n","df_positive_2020 = df_positive_2020[df_positive_2020['exists'] == True].reset_index()\n","# 2019\n","DATA_PATH_2019 = Path(\"/kaggle/input/isic-2019-jpg-256x256-resized\")\n","get_image_path_2019 = lambda p: os.path.join(f'{str(DATA_PATH_2019/\"train-image/image\")}/{p}.jpg')\n","df_train_2019 = pd.read_csv(DATA_PATH_2019/\"train-metadata.csv\")\n","df_positive_2019 = df_train_2019[df_train_2019[\"target\"] == 1].reset_index(drop=True)\n","df_positive_2019['file_path'] = df_positive_2019[\"isic_id\"].apply(get_image_path_2019)\n","df_positive_2019['exists'] = df_positive_2019['file_path'].apply(check_path)\n","df_positive_2019 = df_positive_2019[df_positive_2019['exists'] == True].reset_index()\n","# 2018\n","DATA_PATH_2018 = Path(\"/kaggle/input/isic-2018-jpg-256x256-resized\")\n","get_image_path_2018 = lambda p: os.path.join(f'{str(DATA_PATH_2018/\"train-image/image\")}/{p}.jpg')\n","df_train_2018 = pd.read_csv(DATA_PATH_2018/\"train-metadata.csv\")\n","df_positive_2018 = df_train_2018[df_train_2018[\"target\"] == 1].reset_index(drop=True)\n","df_positive_2018['file_path'] = df_positive_2018[\"isic_id\"].apply(get_image_path_2018)\n","df_positive_2018['exists'] = df_positive_2018['file_path'].apply(check_path)\n","df_positive_2018 = df_positive_2018[df_positive_2018['exists'] == True].reset_index()"],"metadata":{"id":"-kBc1TkMw4wc","papermill":{"duration":9.34957,"end_time":"2024-08-08T05:26:00.48035","exception":false,"start_time":"2024-08-08T05:25:51.13078","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["past_df_positive = pd.concat([df_positive_2018, df_positive_2019, df_positive_2020], axis=0)\n","past_df_positive.head(3)\n","print(f'Number of positive cases: {past_df_positive.shape[0]}')"],"metadata":{"id":"_6d96Py1w4wc","papermill":{"duration":0.034312,"end_time":"2024-08-08T05:26:00.539436","exception":false,"start_time":"2024-08-08T05:26:00.505124","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724447661315,"user_tz":-120,"elapsed":4,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"020f8527-e860-4299-a25b-dfeabd33c83c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Number of positive cases: 5768\n"]}]},{"cell_type":"code","source":["selected_cols = ['isic_id', 'target', 'file_path', 'patient_id']\n","\n","df_now = pd.read_csv(f\"{ROOT_DIR}/train-metadata.csv\")\n","print(\"        df.size, # of positive cases\")\n","print(\"original>\", df_now.shape[0], df_now.target.sum())\n","\n","# augment df\n","if CONFIG[\"replicate_pos\"] >= 2:\n","  df_now = pd.concat([df_now] * CONFIG[\"replicate_pos\"]).reset_index(drop=True)\n","\n","# Positive cases\n","df_positive = df_now[df_now[\"target\"] == 1].reset_index(drop=True)\n","df_positive['file_path'] = df_positive['isic_id'].apply(get_train_file_path)\n","df_positive = pd.concat([df_positive[selected_cols], past_df_positive[selected_cols]], axis = 0).reset_index(drop=True)\n","\n","# Negative cases\n","df_negative = df_now[df_now[\"target\"] == 0].reset_index(drop=True)\n","df_negative = df_negative.sample(frac=1).iloc[:df_positive.shape[0]*CONFIG[\"target_ratio\"], :]\n","df_negative['file_path'] = df_negative['isic_id'].apply(get_train_file_path)\n","df_negative = df_negative[selected_cols]\n","df_negative = df_negative[ df_negative[\"file_path\"].isin(train_images) ]\n","\n","df = pd.concat([df_positive, df_negative]).reset_index(drop=True)\n","print(\"filtered>\", df.shape[0], df.target.sum())\n","\n","df.head(3)"],"metadata":{"id":"jis04ERxMH9A","papermill":{"duration":7.732103,"end_time":"2024-08-08T05:26:08.295596","exception":false,"start_time":"2024-08-08T05:26:00.563493","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":195},"executionInfo":{"status":"ok","timestamp":1724447695684,"user_tz":-120,"elapsed":34371,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"d50abe8f-5ce6-4ac8-e434-5a4008c235da"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["        df.size, # of positive cases\n","original> 401059 393\n","filtered> 36700 7340.0\n"]},{"output_type":"execute_result","data":{"text/plain":["        isic_id  target                                          file_path  \\\n","0  ISIC_0082829     1.0  /kaggle/input/isic-2024-challenge/train-image/...   \n","1  ISIC_0096034     1.0  /kaggle/input/isic-2024-challenge/train-image/...   \n","2  ISIC_0104229     1.0  /kaggle/input/isic-2024-challenge/train-image/...   \n","\n","   patient_id  \n","0  IP_3249371  \n","1  IP_6723298  \n","2  IP_9057861  "],"text/html":["\n","  <div id=\"df-ca23b680-5c07-43b8-b267-dcc313473458\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>isic_id</th>\n","      <th>target</th>\n","      <th>file_path</th>\n","      <th>patient_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ISIC_0082829</td>\n","      <td>1.0</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","      <td>IP_3249371</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ISIC_0096034</td>\n","      <td>1.0</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","      <td>IP_6723298</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ISIC_0104229</td>\n","      <td>1.0</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","      <td>IP_9057861</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ca23b680-5c07-43b8-b267-dcc313473458')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-ca23b680-5c07-43b8-b267-dcc313473458 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-ca23b680-5c07-43b8-b267-dcc313473458');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-bd947fa3-df78-4e01-b7c8-821ecba65e0f\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-bd947fa3-df78-4e01-b7c8-821ecba65e0f')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-bd947fa3-df78-4e01-b7c8-821ecba65e0f button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df","summary":"{\n  \"name\": \"df\",\n  \"rows\": 36700,\n  \"fields\": [\n    {\n      \"column\": \"isic_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 34216,\n        \"samples\": [\n          \"ISIC_7285044\",\n          \"ISIC_2209907\",\n          \"ISIC_4012215\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"target\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.40000544970265095,\n        \"min\": 0.0,\n        \"max\": 1.0,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          0.0,\n          1.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"file_path\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 34707,\n        \"samples\": [\n          \"/kaggle/input/isic-2024-challenge/train-image/image/ISIC_3106721.jpg\",\n          \"/kaggle/input/isic-2024-challenge/train-image/image/ISIC_5352762.jpg\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"patient_id\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 6571,\n        \"samples\": [\n          \"dummy_18517\",\n          \"dummy_18690\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":22}]},{"cell_type":"code","source":["CONFIG['T_max'] = df.shape[0] * (CONFIG[\"n_fold\"]-1) * CONFIG['epochs'] // CONFIG['train_batch_size'] // CONFIG[\"n_fold\"]\n","CONFIG['T_max']"],"metadata":{"id":"SxHsB8bMw4wc","papermill":{"duration":0.033653,"end_time":"2024-08-08T05:26:08.354478","exception":false,"start_time":"2024-08-08T05:26:08.320825","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724447695684,"user_tz":-120,"elapsed":14,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"0318fc63-1ac6-40a9-de6b-506fce47ff83"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["9175"]},"metadata":{},"execution_count":23}]},{"cell_type":"markdown","source":["# Read the Test Data"],"metadata":{"papermill":{"duration":0.024544,"end_time":"2024-08-08T05:26:08.403751","exception":false,"start_time":"2024-08-08T05:26:08.379207","status":"completed"},"tags":[],"id":"qGBoKCJPMQwd"}},{"cell_type":"code","source":["class ISICDataset_for_Test(Dataset):\n","    def __init__(self, df, file_hdf, transforms=None):\n","        self.df = df\n","        self.fp_hdf = h5py.File(file_hdf, mode=\"r\")\n","        self.isic_ids = df['isic_id'].values\n","        self.targets = df['target'].values\n","        self.transforms = transforms\n","\n","    def __len__(self):\n","        return len(self.isic_ids)\n","\n","    def __getitem__(self, index):\n","        isic_id = self.isic_ids[index]\n","        img = np.array( Image.open(BytesIO(self.fp_hdf[isic_id][()])) )\n","        target = self.targets[index]\n","\n","        if self.transforms:\n","            img = self.transforms(image=img)[\"image\"]\n","\n","        return {\n","            'image': img,\n","            'target': target,\n","        }"],"metadata":{"papermill":{"duration":0.035088,"end_time":"2024-08-08T05:26:08.463388","exception":false,"start_time":"2024-08-08T05:26:08.4283","status":"completed"},"tags":[],"trusted":true,"id":"lO9Py-oXMQwd"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Load submission data\n","subm_data = pd.read_csv(TEST_CSV)\n","subm_data['target'] = 0 # dummy\n","display(subm_data.head())"],"metadata":{"papermill":{"duration":0.054824,"end_time":"2024-08-08T05:26:08.543121","exception":false,"start_time":"2024-08-08T05:26:08.488297","status":"completed"},"tags":[],"trusted":true,"id":"7bV643a2MQwd","colab":{"base_uri":"https://localhost:8080/","height":332},"executionInfo":{"status":"ok","timestamp":1724447695684,"user_tz":-120,"elapsed":10,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"7e18154b-e109-46f2-fc50-abaaa1f59d71"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["        isic_id  patient_id  age_approx     sex anatom_site_general  \\\n","0  ISIC_0015657  IP_6074337        45.0    male     posterior torso   \n","1  ISIC_0015729  IP_1664139        35.0  female     lower extremity   \n","2  ISIC_0015740  IP_7142616        65.0    male     posterior torso   \n","\n","   clin_size_long_diam_mm          image_type tbp_tile_type  tbp_lv_A  \\\n","0                    2.70  TBP tile: close-up        3D: XP  22.80433   \n","1                    2.52  TBP tile: close-up        3D: XP  16.64867   \n","2                    3.16  TBP tile: close-up        3D: XP  24.25384   \n","\n","   tbp_lv_Aext  ...  tbp_lv_stdL  tbp_lv_stdLExt  tbp_lv_symm_2axis  \\\n","0    20.007270  ...     1.281532        2.299935           0.479339   \n","1     9.657964  ...     1.271940        2.011223           0.426230   \n","2    19.937380  ...     1.080308        2.705857           0.366071   \n","\n","   tbp_lv_symm_2axis_angle   tbp_lv_x     tbp_lv_y    tbp_lv_z  \\\n","0                       20 -155.06510  1511.222000  113.980100   \n","1                       25 -112.36924   629.535889  -15.019287   \n","2                      110  -84.29282  1303.978000  -28.576050   \n","\n","                                         attribution  copyright_license  \\\n","0             Memorial Sloan Kettering Cancer Center              CC-BY   \n","1  Frazer Institute, The University of Queensland...              CC-BY   \n","2                                        FNQH Cairns              CC-BY   \n","\n","   target  \n","0       0  \n","1       0  \n","2       0  \n","\n","[3 rows x 45 columns]"],"text/html":["\n","  <div id=\"df-8b8404e2-d129-4191-b480-48063861cc0a\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>isic_id</th>\n","      <th>patient_id</th>\n","      <th>age_approx</th>\n","      <th>sex</th>\n","      <th>anatom_site_general</th>\n","      <th>clin_size_long_diam_mm</th>\n","      <th>image_type</th>\n","      <th>tbp_tile_type</th>\n","      <th>tbp_lv_A</th>\n","      <th>tbp_lv_Aext</th>\n","      <th>...</th>\n","      <th>tbp_lv_stdL</th>\n","      <th>tbp_lv_stdLExt</th>\n","      <th>tbp_lv_symm_2axis</th>\n","      <th>tbp_lv_symm_2axis_angle</th>\n","      <th>tbp_lv_x</th>\n","      <th>tbp_lv_y</th>\n","      <th>tbp_lv_z</th>\n","      <th>attribution</th>\n","      <th>copyright_license</th>\n","      <th>target</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ISIC_0015657</td>\n","      <td>IP_6074337</td>\n","      <td>45.0</td>\n","      <td>male</td>\n","      <td>posterior torso</td>\n","      <td>2.70</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>22.80433</td>\n","      <td>20.007270</td>\n","      <td>...</td>\n","      <td>1.281532</td>\n","      <td>2.299935</td>\n","      <td>0.479339</td>\n","      <td>20</td>\n","      <td>-155.06510</td>\n","      <td>1511.222000</td>\n","      <td>113.980100</td>\n","      <td>Memorial Sloan Kettering Cancer Center</td>\n","      <td>CC-BY</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ISIC_0015729</td>\n","      <td>IP_1664139</td>\n","      <td>35.0</td>\n","      <td>female</td>\n","      <td>lower extremity</td>\n","      <td>2.52</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>16.64867</td>\n","      <td>9.657964</td>\n","      <td>...</td>\n","      <td>1.271940</td>\n","      <td>2.011223</td>\n","      <td>0.426230</td>\n","      <td>25</td>\n","      <td>-112.36924</td>\n","      <td>629.535889</td>\n","      <td>-15.019287</td>\n","      <td>Frazer Institute, The University of Queensland...</td>\n","      <td>CC-BY</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ISIC_0015740</td>\n","      <td>IP_7142616</td>\n","      <td>65.0</td>\n","      <td>male</td>\n","      <td>posterior torso</td>\n","      <td>3.16</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>24.25384</td>\n","      <td>19.937380</td>\n","      <td>...</td>\n","      <td>1.080308</td>\n","      <td>2.705857</td>\n","      <td>0.366071</td>\n","      <td>110</td>\n","      <td>-84.29282</td>\n","      <td>1303.978000</td>\n","      <td>-28.576050</td>\n","      <td>FNQH Cairns</td>\n","      <td>CC-BY</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3 rows × 45 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8b8404e2-d129-4191-b480-48063861cc0a')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-8b8404e2-d129-4191-b480-48063861cc0a button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-8b8404e2-d129-4191-b480-48063861cc0a');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-f40fd1d8-e12f-4727-945c-1810ef5d909e\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f40fd1d8-e12f-4727-945c-1810ef5d909e')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-f40fd1d8-e12f-4727-945c-1810ef5d909e button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe"}},"metadata":{}}]},{"cell_type":"code","source":["#subm_data['file_path'] = subm_data['isic_id'].apply(get_test_file_path)\n","#subm_data['target'] = 0 # dummy\n","#subm_data = subm_data[subm_data[\"file_path\"].isin(test_images) ].reset_index(drop=True)\n","#subm_data"],"metadata":{"id":"yKwKqTO0PrFU","papermill":{"duration":0.030842,"end_time":"2024-08-08T05:26:08.599196","exception":false,"start_time":"2024-08-08T05:26:08.568354","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_sub = pd.read_csv(SAMPLE)\n","df_sub"],"metadata":{"papermill":{"duration":0.047348,"end_time":"2024-08-08T05:26:08.671361","exception":false,"start_time":"2024-08-08T05:26:08.624013","status":"completed"},"tags":[],"trusted":true,"id":"Bq5lhxcxMQwd","colab":{"base_uri":"https://localhost:8080/","height":143},"executionInfo":{"status":"ok","timestamp":1724447695685,"user_tz":-120,"elapsed":10,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"7013d67b-e24c-4a0a-c505-200da4d86676"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        isic_id  target\n","0  ISIC_0015657     0.3\n","1  ISIC_0015729     0.3\n","2  ISIC_0015740     0.3"],"text/html":["\n","  <div id=\"df-4ee0ad87-84c9-4db8-aed6-baa39774ba3e\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>isic_id</th>\n","      <th>target</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ISIC_0015657</td>\n","      <td>0.3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ISIC_0015729</td>\n","      <td>0.3</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ISIC_0015740</td>\n","      <td>0.3</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4ee0ad87-84c9-4db8-aed6-baa39774ba3e')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-4ee0ad87-84c9-4db8-aed6-baa39774ba3e button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-4ee0ad87-84c9-4db8-aed6-baa39774ba3e');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-522fcc43-e203-4f67-a7de-3460c47dd528\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-522fcc43-e203-4f67-a7de-3460c47dd528')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-522fcc43-e203-4f67-a7de-3460c47dd528 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_fc8bd5ff-b952-4ef5-92cb-ba7e2c1e229c\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_sub')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_fc8bd5ff-b952-4ef5-92cb-ba7e2c1e229c button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('df_sub');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_sub","summary":"{\n  \"name\": \"df_sub\",\n  \"rows\": 3,\n  \"fields\": [\n    {\n      \"column\": \"isic_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"ISIC_0015657\",\n          \"ISIC_0015729\",\n          \"ISIC_0015740\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"target\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.0,\n        \"min\": 0.3,\n        \"max\": 0.3,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0.3\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":27}]},{"cell_type":"markdown","source":["## <span><h2 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 10px 10px;\">Display Images</h2></span>"],"metadata":{"id":"Sw5pjhBew4wc","papermill":{"duration":0.025494,"end_time":"2024-08-08T05:26:08.722073","exception":false,"start_time":"2024-08-08T05:26:08.696579","status":"completed"},"tags":[]}},{"cell_type":"markdown","source":["## <span><h2 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 10px 10px;\">Target Plot</h2></span>\n","\n","I added positive cases from past data to enlarge the positive cases size."],"metadata":{"id":"h9uTIpTww4wd","papermill":{"duration":0.035256,"end_time":"2024-08-08T05:26:10.364464","exception":false,"start_time":"2024-08-08T05:26:10.329208","status":"completed"},"tags":[]}},{"cell_type":"code","source":["plt.subplot(141)\n","plt.title(\"Total Data - 2024\")\n","df_2024 = pd.read_csv(f\"{ROOT_DIR}/train-metadata.csv\")\n","df_2024['target'].value_counts().plot(kind='bar', figsize=(20,4))\n","plt.subplot(142)\n","plt.title(\"Data combined past positive cases\")\n","df['target'].value_counts().plot(kind='bar', figsize=(20,4))"],"metadata":{"id":"Bv_tIX-5w4wd","papermill":{"duration":4.938687,"end_time":"2024-08-08T05:26:15.33865","exception":false,"start_time":"2024-08-08T05:26:10.399963","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":435},"executionInfo":{"status":"ok","timestamp":1724447700628,"user_tz":-120,"elapsed":4953,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"d4d56d99-9fd9-46ea-df2c-b07f258cbb15"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<Axes: title={'center': 'Data combined past positive cases'}, xlabel='target'>"]},"metadata":{},"execution_count":28},{"output_type":"display_data","data":{"text/plain":["<Figure size 2000x400 with 2 Axes>"],"image/png":"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jx490LZtWwCAp6cnnJ2dMWrUKCxatAharRZz586Fv78/FAoFAGDSpElYvnw5Zs2ahXHjxmHv3r3YtGkTYmP/N3pLcHAwfH190bFjR3Tu3BlLly5Fbm4uxo4dK+bk5+eH4OBgNGjQAEqlElOnToVarS7XSGlERERERFS7VKi4WblyJYBHwz2XtHbtWowZMwZyuRx79uwRCw17e3v4+Phg7ty5YqyhoSF27NiByZMnQ61Ww8TEBL6+vli4cKEY4+joiNjYWAQFBSEiIgKNGjXC6tWrodFoxJihQ4fixo0bCA0NhVarhaurK+Li4iSDDISHh8PAwAA+Pj7Iy8uDRqPBihUrKrSBiIiIiIiodnih59zoOz6T4NXG5xIQvZjatA+tCrVpe/CYUrl4PCF6cVXynBsiIiIiIqKagsUNERERERHpBRY3RERERESkF1jcEBERERGRXmBxQ0REREREeoHFDRERERER6QUWN0REREREpBdY3BARERERkV5gcUNERERERHqBxQ0REREREekFFjdERERERKQXWNwQEREREZFeYHFDRERERER6gcUNERERERHpBRY3RERERESkF1jcEBERERGRXmBxQ0REREREeoHFDRERERER6QUWN0REREREpBdY3BARERERkV5gcUNERERERHqBxQ0REREREekFFjdERFRjHThwAIMGDYKdnR1kMhm2bt0qaR8zZgxkMplk6tevnyTm1q1bGDlyJJRKJczNzeHn54e7d+9KYk6ePInu3bvDyMgI9vb2WLRoUalcNm/eDCcnJxgZGcHFxQU7d+6s9PUlIqIXw+KGiIhqrNzcXLRr1w6RkZFPjOnXrx+uXbsmTv/9738l7SNHjsSZM2eQkJCAHTt24MCBA5g4caLYrtPp4OnpiSZNmiA1NRWLFy/G/PnzsWrVKjEmOTkZw4cPh5+fH44fPw5vb294e3vj9OnTlb/SRET03OpUdwJERERP0r9/f/Tv3/+pMQqFAjY2NmW2nTt3DnFxcThy5Ag6duwIAPjqq68wYMAAfPHFF7Czs8P333+P/Px8rFmzBnK5HK1bt0ZaWhq+/PJLsQiKiIhAv379MHPmTADARx99hISEBCxfvhxRUVGVuMZERPQiKnTmJiwsDJ06dYKZmRmsrKzg7e2NjIwMScyDBw/g7++Phg0bwtTUFD4+PsjKypLEZGZmwsvL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2LiyF1epQkJCEBwcLL7W6XQscIiIiIiIaomXPhS0ubk5WrRogT/++AM2NjbIz89Hdna2JCYrKws2NjYAABsbm1KjpxW/flaMUqmEsbExLCwsYGhoWGZMcR9lUSgUUCqVkomIiIiIiGqHl17c3L17FxcuXICtrS3c3NxQt25dJCYmiu0ZGRnIzMyEWq0GAKjVapw6dUoyqllCQgKUSiWcnZ3FmJJ9FMcU9yGXy+Hm5iaJKSoqQmJiohhDRERERET6pdKLmxkzZiApKQmXLl1CcnIy3nnnHRgaGmL48OFQqVTw8/NDcHAw9u3bh9TUVIwdOxZqtRpdunQBAHh6esLZ2RmjRo3CiRMnEB8fj7lz58Lf3x8KhQIAMGnSJPz555+YNWsW0tPTsWLFCmzatAlBQUFiHsHBwfj666+xbt06nDt3DpMnT0Zubi7Gjh1b2atMREREREQ1QKXfc3PlyhUMHz4c//zzDywtLdGtWzccPHgQlpaWAIDw8HAYGBjAx8cHeXl50Gg0WLFihfh+Q0ND7NixA5MnT4ZarYaJiQl8fX2xcOFCMcbR0RGxsbEICgpCREQEGjVqhNWrV0Oj0YgxQ4cOxY0bNxAaGgqtVgtXV1fExcWVGmSAiIiIiIj0g0wQBKG6k6ipdDodVCoVcnJyavz9Nw5zYqs7Bb1z6TOv6k6BqFarTfvQqlCbtgePKZWLx5PKxe9n5asN39Hy7kNf+j03REREREREVYHFDRERERER6QUWN0REREREpBdY3BARERERkV5gcUNERERERHqBxQ0REREREekFFjdERERERKQXWNwQEREREZFeYHFDRERERER6gcUNERERERHpBRY3RERERESkF1jcEBERERGRXmBxQ0REREREeoHFDRERERER6QUWN0REREREpBdY3BARERERkV5gcUNERERERHqBxQ0REREREekFFjdERERERKQXWNwQEREREZFeYHFDRERERER6gcUNERERERHpBRY3RERERESkF1jcEBERERGRXmBxQ0REREREeoHFDRERERER6YVXoriJjIyEg4MDjIyM4O7ujsOHD1d3SkREVAvxeEJEVLPpfXGzceNGBAcHY968eTh27BjatWsHjUaD69evV3dqRERUi/B4QkRU8+l9cfPll19iwoQJGDt2LJydnREVFYV69ephzZo11Z0aERHVIjyeEBHVfHWqO4GXKT8/H6mpqQgJCRHnGRgYwMPDAykpKaXi8/LykJeXJ77OyckBAOh0upef7AsqyrtX3SnondrwudcmbebFV3cKeuX0Ak11p/BMxX9DgiBUcyYvrqLHE4DHFPqf2vCZ1yb8fla+2vAdLe8xRa+Lm5s3b6KwsBDW1taS+dbW1khPTy8VHxYWhgULFpSab29v/9JypJpLtbS6MyB6str0/bxz5w5UKlV1p/FCKno8AXhMof+pTX+v9GqqTd/RZx1T9Lq4qaiQkBAEBweLr4uKinDr1i00bNgQMpmsGjPTHzqdDvb29rh8+TKUSmV1p0Mkwe9n5RIEAXfu3IGdnV11p1IteEx5ufj3SjUZv5+Vr7zHFL0ubiwsLGBoaIisrCzJ/KysLNjY2JSKVygUUCgUknnm5uYvM8VXllKp5B871Vj8flae2n7GplhFjycAjylVhX+vVJPx+1m5ynNM0esBBeRyOdzc3JCYmCjOKyoqQmJiItRqdTVmRkREtQmPJ0REtYNen7kBgODgYPj6+qJjx47o3Lkzli5ditzcXIwdO7a6UyMiolqExxMioppP74uboUOH4saNGwgNDYVWq4Wrqyvi4uJK3RRKVUOhUGDevHmlLtUgqgn4/aSn4fGkZuHfK9Vk/H5WH5mgD2N0EhERERHRK0+v77khIiIiIqJXB4sbIiIiIiLSCyxuiIiIiIhIL7C4ISIiIiIivcDihoiIiIiI9ILeDwVN1efmzZtYs2YNUlJSoNVqAQA2Njbo2rUrxowZA0tLy2rOkIiIiIj0Cc/c0Etx5MgRtGjRAsuWLYNKpUKPHj3Qo0cPqFQqLFu2DE5OTjh69Gh1p0n0VJcvX8a4ceOqOw0iAnD27FlMmTIF7du3h62tLWxtbdG+fXtMmTIFZ8+ere70iCTy8vKQl5dX3Wm8kvicG3opunTpgnbt2iEqKgoymUzSJggCJk2ahJMnTyIlJaWaMiR6thMnTqBDhw4oLCys7lSIXmm7du2Ct7c3OnToAI1GIz44NSsrCwkJCUhNTcXPP/8MjUZTzZnSqywhIQHh4eFISUmBTqcDACiVSqjVagQHB8PDw6OaM3w1sLihl8LY2BjHjx+Hk5NTme3p6elo37497t+/X8WZEf3Ptm3bntr+559/Yvr06SxuiKpZu3bt8Pbbb2PhwoVlts+fPx8//fQTTp48WcWZET2ybt06jB8/HkOGDClVgO/evRs//PADvvnmG4waNaqaM9V/LG7opXB0dMSCBQswevToMtvXr1+P0NBQXLp0qWoTIyrBwMAAMpkMT9sNymQyFjdE1czY2BhpaWlo2bJlme0ZGRlwdXXlD2ZUbVq0aIFp06bB39+/zPYVK1YgPDwcv//+exVn9urhPTf0UsyYMQMTJ07EtGnTsG3bNhw6dAiHDh3Ctm3bMG3aNEyaNAmzZs2q7jTpFWdra4uffvoJRUVFZU7Hjh2r7hSJCICDgwNiY2Of2B4bG4smTZpUYUZEUpmZmU+97Kxv3764cuVKFWb06uJoafRS+Pv7w8LCAuHh4VixYoX4y7ehoSHc3NwQHR2N9957r5qzpFedm5sbUlNT8fbbb5fZ/qyzOkRUNRYuXIgRI0Zg//798PDwkFzyk5iYiLi4OMTExFRzlvQqa926Nb755hssWrSozPY1a9bA2dm5irN6NfGyNHrpCgoKcPPmTQCAhYUF6tatW80ZET3yyy+/IDc3F/369SuzPTc3F0ePHkXPnj2rODMielxycjKWLVtW6vECarUa06ZNg1qtruYM6VW2f/9+DBw4EE2bNi2zAP/zzz8RGxuLHj16VHOm+o/FDRERERHRC7p06RJWrlyJgwcPlirAJ02aBAcHh+pN8BXB4oaIiIiIiPQCBxQgIiKiWu2DDz7gA3eJCACLGyIiIqrlrly5wkcLUI3m6+uLPn36VHcarwSOlkZERES12vr166s7BaKnsrOzg4EBzylUBd5zQ1TFevXqBVdXVyxdurS6UwFQ8/IhIirLzZs3sWbNmlKjpXXt2hVjxoyBpaVlNWdIRDUBS0iiWig/P7+6UyAiqjJHjhxBixYtsGzZMqhUKvTo0QM9evSASqXCsmXL4OTkhKNHj1Z3mkRPdPnyZd4XVkV45oaoCo0ZMwbr1q2TzPvjjz/w6aefYu/evdBqtWjcuDGmTJmCadOmSd6XnZ2NTp06ITIyEgqFAhcvXkRycjKmTJmC9PR0tGnTBnPnzsU777yD48ePw9XVFQBw+vRpzJw5E7/88gtMTEzg6emJ8PBwWFhYlJnPxYsXOVwlEdUoXbp0Qbt27RAVFQWZTCZpEwQBkyZNwsmTJ5GSklJNGRI93YkTJ9ChQwfxoeb08vCeG6IqFBERgfPnz6NNmzZYuHAhAKB+/fpo1KgRNm/ejIYNGyI5ORkTJ06Era0t3nvvPfG9iYmJUCqVSEhIAADodDoMGjQIAwYMQExMDP766y8EBgZKlpednY0+ffpg/PjxCA8Px/379zF79my899572Lt3b5n58NIOIqppTpw4gejo6FKFDQDIZDIEBQWhffv21ZAZ0SPbtm17avuff/5ZRZkQixuiKqRSqSCXy1GvXj3Y2NiI8xcsWCD+29HRESkpKdi0aZOkuDExMcHq1ashl8sBQPwF8+uvv4aRkRGcnZ3x999/Y8KECeJ7li9fjvbt2+PTTz8V561Zswb29vY4f/48WrRoUWY+REQ1iY2NDQ4fPgwnJ6cy2w8fPiw+EZ6oOnh7e0Mmk+FpF0SVVZxT5WNxQ1QDREZGYs2aNcjMzMT9+/eRn58vXlZWzMXFRSxsACAjIwNt27aFkZGROK9z586S95w4cQL79u2DqalpqWVeuHABLVq0qNwVISJ6CWbMmIGJEyciNTUVffv2FQuZrKwsJCYm4uuvv8YXX3xRzVnSq8zW1hYrVqzA22+/XWZ7Wloa3NzcqjirVxOLG6JqtmHDBsyYMQNLliyBWq2GmZkZFi9ejEOHDkniTExMKtz33bt3MWjQIHz++eel2mxtbZ87ZyKiquTv7w8LCwuEh4djxYoV4n0LhoaGcHNzQ3R0tORMN1FVc3NzQ2pq6hOLm2ed1aHKw+KGqIrJ5XLJDYW//fYbunbtiilTpojzLly48Mx+WrZsie+++w55eXlQKBQAHo0oVFKHDh3w448/wsHBAXXqlP3n/ng+REQ10dChQzF06FAUFBTg5s2bAAALCwvUrVu3mjMjAmbOnInc3Nwntjdv3hz79u2rwoxeXRwKmqiKOTg44NChQ7h06RJu3ryJ119/HUePHkV8fDzOnz+Pf//736WKlLKMGDECRUVFmDhxIs6dO4f4+Hjxsozi63r9/f1x69YtDB8+HEeOHMGFCxcQHx+PsWPHigXN4/kUFRW9vJUnInpBdevWha2tLWxtbVnYUI3RvXt39OvX74ntJiYm6NmzZxVm9OpicUNUxWbMmAFDQ0M4OzvD0tISGo0GgwcPxtChQ+Hu7o5//vlHchbnSZRKJbZv3460tDS4urriww8/RGhoKACI9+HY2dnht99+Q2FhITw9PeHi4oLAwECYm5uLT0p+PJ/MzMyXt/JERERELxGfc0OkR77//nuMHTsWOTk5MDY2ru50iIiIiKoU77khqsXWr1+Ppk2b4rXXXsOJEyfEZ9iwsCEiIqJXEYsbolpMq9UiNDQUWq0Wtra2ePfdd/HJJ59Ud1pERERE1YKXpRERERERkV7ggAJEREREtVCvXr0QGBhY3WmIalo+9GpicUNERET0isrPz6/uFIgqFYsbIiIiolpmzJgxSEpKQkREBGQyGWQyGS5cuAA/Pz84OjrC2NgYLVu2RERERKn3eXt745NPPoGdnR1atmwJAEhOToarqyuMjIzQsWNHbN26FTKZDGlpaeJ7T58+jf79+8PU1BTW1tYYNWqU+EDVsvK5dOlSVW0OIhEHFCAiIiKqZSIiInD+/Hm0adMGCxcuBADUr18fjRo1wubNm9GwYUMkJydj4sSJsLW1xXvvvSe+NzExEUqlEgkJCQAAnU6HQYMGYcCAAYiJicFff/1V6vKy7Oxs9OnTB+PHj0d4eDju378vjtC5d+/eMvOxtLSsmo1BVAKLGyIiIqJaRqVSQS6Xo169erCxsRHnL1iwQPy3o6MjUlJSsGnTJklxY2JigtWrV0MulwMAoqKiIJPJ8PXXX8PIyAjOzs74+++/MWHCBPE9y5cvR/v27fHpp5+K89asWQN7e3ucP38eLVq0KDMfoqrG4oaIiIhIT0RGRmLNmjXIzMzE/fv3kZ+fD1dXV0mMi4uLWNgAQEZGBtq2bQsjIyNxXufOnSXvOXHiBPbt2wdTU9NSy7xw4QJatGhRuStC9JxY3BARERHpgQ0bNmDGjBlYsmQJ1Go1zMzMsHjxYhw6dEgSZ2JiUuG+7969i0GDBuHzzz8v1WZra/vcORNVNhY3RERERLWQXC5HYWGh+Pq3335D165dMWXKFHHehQsXntlPy5Yt8d133yEvLw8KhQIAcOTIEUlMhw4d8OOPP8LBwQF16pT938fH8yGqDhwtjYiIiKgWcnBwwKFDh3Dp0iXcvHkTr7/+Oo4ePYr4+HicP38e//73v0sVKWUZMWIEioqKMHHiRJw7dw7x8fH44osvAAAymQwA4O/vj1u3bmH48OE4cuQILly4gPj4eIwdO1YsaB7Pp6io6OWtPNETsLghIiIiqoVmzJgBQ0NDODs7w9LSEhqNBoMHD8bQoUPh7u6Of/75R3IW50mUSiW2b9+OtLQ0uLq64sMPP0RoaCgAiPfh2NnZ4bfffkNhYSE8PT3h4uKCwMBAmJubw8DAoMx8MjMzX97KEz2BTBAEobqTICIiIqKa4/vvv8fYsWORk5MDY2Pj6k6HqNx4zw0RERHRK279+vVo2rQpXnvtNZw4cUJ8hg0LG6ptWNwQERERveK0Wi1CQ0Oh1Wpha2uLd999F5988kl1p0VUYbwsjYiIiIiI9AIHFCAiIiIiIr3A4oaIiIiIiPQCixsiIiIiItILLG6IiIiIiEgvsLghIiIiIiK9wOKGiIiIiIj0AosbIiIiIiLSCyxuiIiIiIhIL/w/VSbxnhaxEHoAAAAASUVORK5CYII=\n"},"metadata":{}}]},{"cell_type":"markdown","source":["## <span><h2 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 10px 10px;\">Create Folds</h2></span>"],"metadata":{"id":"MmkDFqTsw4wd","papermill":{"duration":0.035869,"end_time":"2024-08-08T05:26:15.411635","exception":false,"start_time":"2024-08-08T05:26:15.375766","status":"completed"},"tags":[]}},{"cell_type":"code","source":["sgkf = StratifiedGroupKFold(n_splits=CONFIG['n_fold']) # I don't why my SGKF doesn't work without patient_id\n","from sklearn.model_selection import KFold\n","kf = KFold(CONFIG['n_fold'], shuffle=True)\n","for fold, ( _, val_) in enumerate(kf.split(df)):\n","    df.loc[val_ , \"kfold\"] = int(fold)"],"metadata":{"id":"XsqGyhGAw4wd","papermill":{"duration":0.054535,"end_time":"2024-08-08T05:26:15.503399","exception":false,"start_time":"2024-08-08T05:26:15.448864","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## <span><h2 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 10px 10px;\">Dataset Class</h2></span>"],"metadata":{"id":"AcDzNUZjw4wd","papermill":{"duration":0.036328,"end_time":"2024-08-08T05:26:15.575784","exception":false,"start_time":"2024-08-08T05:26:15.539456","status":"completed"},"tags":[]}},{"cell_type":"code","source":["class ISICDataset_for_Train(Dataset):\n","    def __init__(self, df, transforms=None):\n","        self.df_positive = df[df[\"target\"] == 1].reset_index()\n","        self.df_negative = df[df[\"target\"] == 0].reset_index()\n","        self.file_names_positive = self.df_positive['file_path'].values\n","        self.file_names_negative = self.df_negative['file_path'].values\n","        self.targets_positive = self.df_positive['target'].values\n","        self.targets_negative = self.df_negative['target'].values\n","        self.transforms = transforms\n","\n","    def __len__(self): # seems it is not used\n","        return len(self.df_positive) * 4\n","\n","    def __getitem__(self, index):\n","        if random.random() <= 1./(CONFIG[\"target_ratio\"]+1) :       # modified, was 0.25:\n","            df = self.df_positive\n","            file_names = self.file_names_positive\n","            targets = self.targets_positive\n","        else:\n","            df = self.df_negative\n","            file_names = self.file_names_negative\n","            targets = self.targets_negative\n","        index = index % df.shape[0]\n","\n","        img_path = file_names[index]\n","        img = cv2.imread(img_path)\n","        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n","        target = targets[index]\n","\n","        if self.transforms:\n","            img = self.transforms(image=img)[\"image\"]\n","\n","        return {\n","            'image': img,\n","            'target': target\n","        }\n","\n","class ISICDataset(Dataset):\n","    def __init__(self, df, transforms=None):\n","        self.df = df\n","        self.file_names = df['file_path'].values\n","        self.targets = df['target'].values\n","        self.transforms = transforms\n","\n","    def __len__(self):\n","        return len(self.df)\n","\n","    def __getitem__(self, index):\n","        img_path = self.file_names[index]\n","        img = cv2.imread(img_path)\n","        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n","        target = self.targets[index]\n","\n","        if self.transforms:\n","            img = self.transforms(image=img)[\"image\"]\n","\n","        return {\n","            'image': img,\n","            'target': target\n","        }"],"metadata":{"id":"4AjH4W_Dw4wd","papermill":{"duration":0.051684,"end_time":"2024-08-08T05:26:15.663645","exception":false,"start_time":"2024-08-08T05:26:15.611961","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## <span><h2 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 20px 20px\">Augmentations</h2></span>"],"metadata":{"id":"sYnldaqHw4we","papermill":{"duration":0.036182,"end_time":"2024-08-08T05:26:15.736194","exception":false,"start_time":"2024-08-08T05:26:15.700012","status":"completed"},"tags":[]}},{"cell_type":"code","source":["data_transforms = {\n","    \"train\": A.Compose([\n","        A.Resize(CONFIG['img_size'], CONFIG['img_size']),\n","        A.RandomRotate90(p=0.5),\n","        A.Flip(p=0.5),\n","        A.Downscale(p=0.25),\n","        A.ShiftScaleRotate(shift_limit=0.1,\n","                           scale_limit=0.15,\n","                           rotate_limit=60,\n","                           p=0.5),\n","        A.HueSaturationValue(\n","                hue_shift_limit=0.2,\n","                sat_shift_limit=0.2,\n","                val_shift_limit=0.2,\n","                p=0.5\n","            ),\n","        A.RandomBrightnessContrast(\n","                brightness_limit=(-0.1,0.1),\n","                contrast_limit=(-0.1, 0.1),\n","                p=0.5\n","            ),\n","        A.Normalize(\n","                mean=[0.485, 0.456, 0.406],\n","                std=[0.229, 0.224, 0.225],\n","                max_pixel_value=255.0,\n","                p=1.0\n","            ),\n","        ToTensorV2()], p=1.),\n","\n","    \"valid\": A.Compose([\n","        A.Resize(CONFIG['img_size'], CONFIG['img_size']),\n","        A.Normalize(\n","                mean=[0.485, 0.456, 0.406],\n","                std=[0.229, 0.224, 0.225],\n","                max_pixel_value=255.0,\n","                p=1.0\n","            ),\n","        ToTensorV2()], p=1.)\n","}"],"metadata":{"id":"9HEG4I2jw4we","papermill":{"duration":0.048267,"end_time":"2024-08-08T05:26:15.82049","exception":false,"start_time":"2024-08-08T05:26:15.772223","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def prepare_loaders(df, fold):\n","    df_train = df[df.kfold <= CONFIG[\"n_fold\"]].reset_index(drop=True)\n","    df_valid = df[df.kfold == fold].reset_index(drop=True)\n","\n","    train_dataset = ISICDataset_for_Train(df_train, transforms=data_transforms[\"train\"])\n","    #train_dataset = ISICDataset(df_train, transforms=data_transforms[\"train\"])\n","    valid_dataset = ISICDataset(df_valid, transforms=data_transforms[\"valid\"])\n","\n","    train_loader = DataLoader(train_dataset, batch_size=CONFIG['train_batch_size'],\n","                              num_workers=2, shuffle=True, pin_memory=True, drop_last=True)\n","    valid_loader = DataLoader(valid_dataset, batch_size=CONFIG['valid_batch_size'],\n","                              num_workers=2, shuffle=False, pin_memory=True)\n","\n","    return train_loader, valid_loader"],"metadata":{"papermill":{"duration":0.045278,"end_time":"2024-08-08T05:26:17.579353","exception":false,"start_time":"2024-08-08T05:26:17.534075","status":"completed"},"tags":[],"trusted":true,"id":"WSXf4b-aXxYx"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 40px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px; text-align:center\">Create Model</h1></span>\n","## <span><h2 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px\">GeM Pooling</h2></span>"],"metadata":{"id":"MbPF2iWDw4we","papermill":{"duration":0.036009,"end_time":"2024-08-08T05:26:15.893321","exception":false,"start_time":"2024-08-08T05:26:15.857312","status":"completed"},"tags":[]}},{"cell_type":"code","source":["class GeM(nn.Module):\n","    def __init__(self, p=3, eps=1e-6):\n","        super(GeM, self).__init__()\n","        self.p = nn.Parameter(torch.ones(1)*p)\n","        self.eps = eps\n","\n","    def forward(self, x):\n","        return self.gem(x, p=self.p, eps=self.eps)\n","\n","    def gem(self, x, p=3, eps=1e-6):\n","        return F.avg_pool2d(x.clamp(min=eps).pow(p), (x.size(-2), x.size(-1))).pow(1./p)\n","\n","    def __repr__(self):\n","        return self.__class__.__name__ + \\\n","                '(' + 'p=' + '{:.4f}'.format(self.p.data.tolist()[0]) + \\\n","                ', ' + 'eps=' + str(self.eps) + ')'"],"metadata":{"papermill":{"duration":0.046031,"end_time":"2024-08-08T05:26:15.975332","exception":false,"start_time":"2024-08-08T05:26:15.929301","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.838762Z","iopub.execute_input":"2024-08-10T08:14:32.839237Z","iopub.status.idle":"2024-08-10T08:14:32.853298Z","shell.execute_reply.started":"2024-08-10T08:14:32.839181Z","shell.execute_reply":"2024-08-10T08:14:32.851694Z"},"trusted":true,"id":"RBjFD8cEC_1H"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["class ISICModel(nn.Module):\n","    def __init__(self, model_name, num_classes=1, pretrained=True, checkpoint_path=None):\n","        super(ISICModel, self).__init__()\n","        self.model = timm.create_model(model_name, pretrained=pretrained, checkpoint_path=checkpoint_path)\n","        #self.model = timm.create_model(model_name, pretrained=pretrained)\n","        #self.model = torchvision.models.efficientnet_b0(weights = 'DEFAULT')\n","        #print(self.model)\n","        #for param in self.model.parameters():\n","            #param.requires_grad = False\n","        in_features = self.model.classifier.in_features\n","        self.model.classifier = nn.Identity()\n","        self.model.global_pool = nn.Identity()\n","        self.pooling = GeM()\n","        self.linear = nn.Linear(in_features, num_classes)\n","        self.sigmoid = nn.Sigmoid()\n","\n","    def forward(self, images):\n","        features = self.model(images)\n","        pooled_features = self.pooling(features).flatten(1)\n","        output = self.sigmoid(self.linear(pooled_features))\n","        return output\n","\n","torch.cuda.empty_cache()\n","#model = ISICModel(CONFIG['model_name'], checkpoint_path=CONFIG['checkpoint_path'])\n","model = ISICModel(CONFIG['model_name'])\n","model.to(CONFIG['device']);"],"metadata":{"papermill":{"duration":0.778828,"end_time":"2024-08-08T05:26:16.790309","exception":false,"start_time":"2024-08-08T05:26:16.011481","status":"completed"},"tags":[],"execution":{"iopub.status.busy":"2024-08-10T08:14:32.85486Z","iopub.execute_input":"2024-08-10T08:14:32.855392Z","iopub.status.idle":"2024-08-10T08:15:15.44899Z","shell.execute_reply.started":"2024-08-10T08:14:32.855346Z","shell.execute_reply":"2024-08-10T08:15:15.446589Z"},"trusted":true,"executionInfo":{"status":"ok","timestamp":1724447703013,"user_tz":-120,"elapsed":2400,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"colab":{"base_uri":"https://localhost:8080/","height":49,"referenced_widgets":["29d822209ecd452586238d8bd055a70d","f866f96700aa4435bfcf9e56ef314ff4","850704eef6ba478789bf296c6b131868","4386375f1a6648b89900950cb01e87f8","f6af7986750941c2b093234b0e5cccc2","c92e6cf16dc44773be92c30fceb4603c","389dde8eb8344ba9800ef335d49ab646","2ef4415a899a4bcfa3b842d2874ffbc5","f4cdab05b9aa4b9ca9c786ba467bb9e5","093f456daf4147a097381ab39d1e2744","77e4058a35904e328dbd9abae31d4d33"]},"id":"fKg7qv4fC_1P","outputId":"4d654655-1e74-4136-f6cc-eeeba539ca82"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["model.safetensors:   0%|          | 0.00/57.4M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"29d822209ecd452586238d8bd055a70d"}},"metadata":{}}]},{"cell_type":"markdown","source":[],"metadata":{"id":"JRQTykkRC_1Q"}},{"cell_type":"code","source":["torch.save(model, path_isic_data+\"zinneke_picture\")"],"metadata":{"id":"JcvkMMZrC_1Q"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model = torch.load(path_isic_data+\"zinneke_picture\")"],"metadata":{"id":"aJB1hl0VC_1Q"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px;\">Loss Function</h1></span>"],"metadata":{"id":"IVn8VUx5w4we","papermill":{"duration":0.036201,"end_time":"2024-08-08T05:26:16.863722","exception":false,"start_time":"2024-08-08T05:26:16.827521","status":"completed"},"tags":[]}},{"cell_type":"code","source":["def criterion(outputs, targets):\n","    return nn.BCELoss()(outputs, targets)"],"metadata":{"id":"Nu6OTZN4w4we","papermill":{"duration":0.043234,"end_time":"2024-08-08T05:26:16.943194","exception":false,"start_time":"2024-08-08T05:26:16.89996","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 20px 20px\">Training Function</h1></span>"],"metadata":{"id":"5NOg4hfjw4wf","papermill":{"duration":0.036219,"end_time":"2024-08-08T05:26:17.015518","exception":false,"start_time":"2024-08-08T05:26:16.979299","status":"completed"},"tags":[]}},{"cell_type":"code","source":["def aucskl(y_score, y_true):\n","    # using sklearn.metric functions: (1) roc_curve and (2) auc\n","    fpr, tpr, _ = roc_curve(y_true, y_score, sample_weight=None)\n","    auc_skl = auc(fpr, tpr)\n","    if np.isnan(auc_skl): auc_skl = 0.\n","    return auc_skl"],"metadata":{"trusted":true,"id":"xmLptocyMQwk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def train_one_epoch(model, optimizer, scheduler, dataloader, device, epoch):\n","    model.train()\n","\n","    dataset_size = 0\n","    running_loss = 0.0\n","    running_auroc  = 0.0\n","\n","    bar = tqdm(enumerate(dataloader), total=len(dataloader))\n","    for step, data in bar:\n","        images = data['image'].to(device, dtype=torch.float)\n","        targets = data['target'].to(device, dtype=torch.float)\n","\n","        batch_size = images.size(0)\n","\n","        outputs = model(images).squeeze()\n","        loss = criterion(outputs, targets)\n","        loss = loss / CONFIG['n_accumulate']\n","\n","        loss.backward()\n","\n","        if (step + 1) % CONFIG['n_accumulate'] == 0:\n","            optimizer.step()\n","\n","            # zero the parameter gradients\n","            optimizer.zero_grad()\n","\n","            if scheduler is not None:\n","                scheduler.step()\n","\n","        #auroc = binary_auroc(input=outputs.squeeze(), target=targets).item()\n","        auroc = aucskl(outputs.detach().cpu().numpy(), targets.detach().cpu().numpy())\n","\n","        running_loss += (loss.item() * batch_size)\n","        running_auroc  += (auroc * batch_size)\n","        dataset_size += batch_size\n","\n","        epoch_loss = running_loss / dataset_size\n","        epoch_auroc = running_auroc / dataset_size\n","\n","        bar.set_postfix(Epoch=epoch, Train_Loss=epoch_loss, Train_Auroc=epoch_auroc,\n","                        LR=optimizer.param_groups[0]['lr'])\n","    gc.collect()\n","\n","    return epoch_loss, epoch_auroc"],"metadata":{"id":"23dFfm8_w4wf","papermill":{"duration":0.048582,"end_time":"2024-08-08T05:26:17.10052","exception":false,"start_time":"2024-08-08T05:26:17.051938","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 20px 20px\">Validation Function</h1></span>"],"metadata":{"id":"bKAub0lRw4wf","papermill":{"duration":0.03595,"end_time":"2024-08-08T05:26:17.172507","exception":false,"start_time":"2024-08-08T05:26:17.136557","status":"completed"},"tags":[]}},{"cell_type":"code","source":["@torch.inference_mode()\n","def valid_one_epoch(model, dataloader, device, epoch):\n","    model.eval()\n","\n","    dataset_size = 0\n","    running_loss = 0.0\n","    running_auroc = 0.0\n","\n","    bar = tqdm(enumerate(dataloader), total=len(dataloader))\n","    for step, data in bar:\n","        images = data['image'].to(device, dtype=torch.float)\n","        targets = data['target'].to(device, dtype=torch.float)\n","\n","        batch_size = images.size(0)\n","        outputs = model(images).squeeze()\n","        loss = criterion(outputs, targets)\n","        #auroc = binary_auroc(input=outputs.squeeze(), target=targets).item()\n","        auroc = aucskl(outputs.detach().cpu().numpy(), targets.detach().cpu().numpy())\n","        running_loss += (loss.item() * batch_size)\n","        running_auroc  += (auroc * batch_size)\n","        dataset_size += batch_size\n","\n","        epoch_loss = running_loss / dataset_size\n","        epoch_auroc = running_auroc / dataset_size\n","\n","        bar.set_postfix(Epoch=epoch, Valid_Loss=epoch_loss, Valid_Auroc=epoch_auroc,\n","                        LR=optimizer.param_groups[0]['lr'])\n","    gc.collect()\n","\n","    return epoch_loss, epoch_auroc"],"metadata":{"id":"m7Pblwfow4wf","papermill":{"duration":0.048479,"end_time":"2024-08-08T05:26:17.257097","exception":false,"start_time":"2024-08-08T05:26:17.208618","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 40px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px; text-align:center\">Training</h1></span>"],"metadata":{"id":"6I3RXTRqw4wg","papermill":{"duration":0.03628,"end_time":"2024-08-08T05:26:17.329919","exception":false,"start_time":"2024-08-08T05:26:17.293639","status":"completed"},"tags":[]}},{"cell_type":"code","source":["def run_training(model, optimizer, scheduler, device, num_epochs):\n","    if torch.cuda.is_available():\n","        print(\"[INFO] Using GPU: {}\\n\".format(torch.cuda.get_device_name()))\n","\n","    start = time.time()\n","    best_model_wts = copy.deepcopy(model.state_dict())\n","    best_epoch_auroc = -np.inf\n","    best_train_loss = np.inf\n","    history = defaultdict(list)\n","\n","    for epoch in range(1, num_epochs + 1):\n","        gc.collect()\n","        train_epoch_loss, train_epoch_auroc = train_one_epoch(model, optimizer, scheduler,\n","                                           dataloader=train_loader,\n","                                           device=CONFIG['device'], epoch=epoch)\n","\n","        val_epoch_loss, val_epoch_auroc = valid_one_epoch(model, valid_loader, device=CONFIG['device'],\n","                                         epoch=epoch)\n","\n","        history['Train Loss'].append(train_epoch_loss)\n","        history['Valid Loss'].append(val_epoch_loss)\n","        history['Train AUROC'].append(train_epoch_auroc)\n","        history['Valid AUROC'].append(val_epoch_auroc)\n","        history['lr'].append( scheduler.get_lr()[0] )\n","        if train_epoch_loss <= best_train_loss:\n","            print(f\"Train Loss Improved ({best_train_loss} ---> {train_epoch_loss})\")\n","            best_train_loss = train_epoch_loss\n","            #best_model_wts = copy.deepcopy(model.state_dict())\n","            PATH = \"best_TRAIN_LOSS_model.bin\"\n","            torch.save(model.state_dict(), PATH)\n","            # Save a model file from the current directory\n","            print(f\"Model Saved\")\n","\n","        if best_epoch_auroc <= train_epoch_auroc:\n","            print(f\"Train AUROC Improved ({best_epoch_auroc} ---> {train_epoch_auroc})\")\n","            best_epoch_auroc = train_epoch_auroc\n","            best_model_wts = copy.deepcopy(model.state_dict())\n","            PATH = \"best_AUROC_model.bin\"\n","            torch.save(model.state_dict(), PATH)\n","            # Save a model file from the current directory\n","            print(f\"Model Saved\")\n","\n","\n","\n","        print()\n","\n","    end = time.time()\n","    time_elapsed = end - start\n","    print('Training complete in {:.0f}h {:.0f}m {:.0f}s'.format(\n","        time_elapsed // 3600, (time_elapsed % 3600) // 60, (time_elapsed % 3600) % 60))\n","    print(\"Best AUROC: {:.4f}\".format(best_epoch_auroc))\n","    print(\"Best Loss: {:.4f}\".format(best_train_loss))\n","\n","    # load best model weights\n","    model.load_state_dict(best_model_wts)\n","\n","    return model, history"],"metadata":{"id":"abXIGqdHw4wg","papermill":{"duration":0.050961,"end_time":"2024-08-08T05:26:17.417074","exception":false,"start_time":"2024-08-08T05:26:17.366113","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def fetch_scheduler(optimizer):\n","    if CONFIG['scheduler'] == 'CosineAnnealingLR':\n","        scheduler = lr_scheduler.CosineAnnealingLR(optimizer,T_max=CONFIG['T_max'],\n","                                                   eta_min=CONFIG['min_lr'])\n","    elif CONFIG['scheduler'] == 'CosineAnnealingWarmRestarts':\n","        scheduler = lr_scheduler.CosineAnnealingWarmRestarts(optimizer,T_0=CONFIG['T_0'],\n","                                                             eta_min=CONFIG['min_lr'])\n","    elif CONFIG['scheduler'] == None:\n","        return None\n","\n","    return scheduler"],"metadata":{"id":"NXA3ugA5w4wl","papermill":{"duration":0.044224,"end_time":"2024-08-08T05:26:17.497711","exception":false,"start_time":"2024-08-08T05:26:17.453487","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def prepare_loaders(df, fold):\n","    df_train = df[df.kfold <= CONFIG[\"n_fold\"]].reset_index(drop=True)\n","    df_valid = df[df.kfold <= 1].reset_index(drop=True)\n","\n","#     train_dataset = ISICDataset_for_Train(df_train, transforms=data_transforms[\"train\"])\n","    train_dataset = ISICDataset(df_train, transforms=data_transforms[\"train\"])\n","    valid_dataset = ISICDataset(df_valid, transforms=data_transforms[\"valid\"])\n","\n","    train_loader = DataLoader(train_dataset, batch_size=CONFIG['train_batch_size'],\n","                              num_workers=2, shuffle=True, pin_memory=True, drop_last=True)\n","    valid_loader = DataLoader(valid_dataset, batch_size=CONFIG['valid_batch_size'],\n","                              num_workers=2, shuffle=False, pin_memory=True)\n","\n","    return train_loader, valid_loader"],"metadata":{"id":"Ryk6hWc3w4wl","papermill":{"duration":0.045278,"end_time":"2024-08-08T05:26:17.579353","exception":false,"start_time":"2024-08-08T05:26:17.534075","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## <span><h1 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 20px 20px\">Prepare Dataloader</h1></span>"],"metadata":{"id":"dLV1pSNZw4wl","papermill":{"duration":0.036243,"end_time":"2024-08-08T05:26:17.651888","exception":false,"start_time":"2024-08-08T05:26:17.615645","status":"completed"},"tags":[]}},{"cell_type":"code","source":["train_loader, valid_loader = prepare_loaders(df, fold=CONFIG[\"fold\"])"],"metadata":{"id":"cFNmeDX_w4wl","papermill":{"duration":0.049401,"end_time":"2024-08-08T05:26:17.737492","exception":false,"start_time":"2024-08-08T05:26:17.688091","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["\n","## <span><h1 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 20px 20px\">Define Optimizer and Scheduler</h1></span>"],"metadata":{"id":"4z9tVPRuw4wl","papermill":{"duration":0.036075,"end_time":"2024-08-08T05:26:17.810299","exception":false,"start_time":"2024-08-08T05:26:17.774224","status":"completed"},"tags":[]}},{"cell_type":"code","source":["optimizer = optim.Adam(model.parameters(), lr=CONFIG['learning_rate'],\n","                       weight_decay=CONFIG['weight_decay'])\n","scheduler = fetch_scheduler(optimizer)"],"metadata":{"id":"eAH9ZZSjw4wl","papermill":{"duration":0.045972,"end_time":"2024-08-08T05:26:17.892749","exception":false,"start_time":"2024-08-08T05:26:17.846777","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## <span><h1 style = \"font-family: garamond; font-size: 30px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 20px 20px\">Start Training</h1></span>"],"metadata":{"id":"80JesmAnw4wl","papermill":{"duration":0.036163,"end_time":"2024-08-08T05:26:17.965128","exception":false,"start_time":"2024-08-08T05:26:17.928965","status":"completed"},"tags":[]}},{"cell_type":"code","source":["model, history = run_training(model, optimizer, scheduler,\n","                              device=CONFIG['device'],\n","                              num_epochs=CONFIG['epochs'])"],"metadata":{"id":"HgGzRq0ew4wm","papermill":{"duration":2463.394798,"end_time":"2024-08-08T06:07:21.396178","exception":false,"start_time":"2024-08-08T05:26:18.00138","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724454940862,"user_tz":-120,"elapsed":7231873,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"62b33224-4c74-4e68-ba04-37c9a4671a1f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[INFO] Using GPU: Tesla T4\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [11:20<00:00,  1.69it/s, Epoch=1, LR=4.81e-5, Train_Auroc=0.979, Train_Loss=0.119]\n","100%|██████████| 230/230 [01:17<00:00,  2.98it/s, Epoch=1, LR=4.81e-5, Valid_Auroc=0.00436, Valid_Loss=0.0698]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (inf ---> 0.11856883797098933)\n","Model Saved\n","Train AUROC Improved (-inf ---> 0.9785098415478057)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:56<00:00,  1.74it/s, Epoch=2, LR=4.28e-5, Train_Auroc=0.991, Train_Loss=0.083]\n","100%|██████████| 230/230 [01:13<00:00,  3.15it/s, Epoch=2, LR=4.28e-5, Valid_Auroc=0.00436, Valid_Loss=0.0521]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (0.11856883797098933 ---> 0.08296822862460702)\n","Model Saved\n","Train AUROC Improved (0.9785098415478057 ---> 0.9910544424406111)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:50<00:00,  1.76it/s, Epoch=3, LR=3.47e-5, Train_Auroc=0.995, Train_Loss=0.0659]\n","100%|██████████| 230/230 [01:10<00:00,  3.26it/s, Epoch=3, LR=3.47e-5, Valid_Auroc=0.00436, Valid_Loss=0.0313]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (0.08296822862460702 ---> 0.0659374720303189)\n","Model Saved\n","Train AUROC Improved (0.9910544424406111 ---> 0.9952657199766358)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:39<00:00,  1.79it/s, Epoch=4, LR=2.53e-5, Train_Auroc=0.997, Train_Loss=0.0527]\n","100%|██████████| 230/230 [01:12<00:00,  3.18it/s, Epoch=4, LR=2.53e-5, Valid_Auroc=0.00436, Valid_Loss=0.0276]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (0.0659374720303189 ---> 0.05269974295820319)\n","Model Saved\n","Train AUROC Improved (0.9952657199766358 ---> 0.9972168944820058)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:42<00:00,  1.78it/s, Epoch=5, LR=1.58e-5, Train_Auroc=0.999, Train_Loss=0.0385]\n","100%|██████████| 230/230 [01:11<00:00,  3.23it/s, Epoch=5, LR=1.58e-5, Valid_Auroc=0.00436, Valid_Loss=0.0101]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (0.05269974295820319 ---> 0.0384724442140556)\n","Model Saved\n","Train AUROC Improved (0.9972168944820058 ---> 0.9987618521454393)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:38<00:00,  1.80it/s, Epoch=6, LR=7.78e-6, Train_Auroc=0.998, Train_Loss=0.0291]\n","100%|██████████| 230/230 [01:11<00:00,  3.20it/s, Epoch=6, LR=7.78e-6, Valid_Auroc=0.00436, Valid_Loss=0.00729]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (0.0384724442140556 ---> 0.029148060782505956)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:49<00:00,  1.76it/s, Epoch=7, LR=2.4e-6, Train_Auroc=0.998, Train_Loss=0.0226]\n","100%|██████████| 230/230 [01:11<00:00,  3.23it/s, Epoch=7, LR=2.4e-6, Valid_Auroc=0.00436, Valid_Loss=0.00537]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (0.029148060782505956 ---> 0.02259454130308652)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:50<00:00,  1.76it/s, Epoch=8, LR=5e-7, Train_Auroc=0.999, Train_Loss=0.0186]\n","100%|██████████| 230/230 [01:12<00:00,  3.18it/s, Epoch=8, LR=5e-7, Valid_Auroc=0.00436, Valid_Loss=0.00376]\n"]},{"output_type":"stream","name":"stdout","text":["Train Loss Improved (0.02259454130308652 ---> 0.018605871072774883)\n","Model Saved\n","Train AUROC Improved (0.9987618521454393 ---> 0.9989231932450897)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:46<00:00,  1.77it/s, Epoch=9, LR=2.36e-6, Train_Auroc=1, Train_Loss=0.0199]\n","100%|██████████| 230/230 [01:11<00:00,  3.21it/s, Epoch=9, LR=2.36e-6, Valid_Auroc=0.00436, Valid_Loss=0.00406]\n"]},{"output_type":"stream","name":"stdout","text":["Train AUROC Improved (0.9989231932450897 ---> 0.999758099071305)\n","Model Saved\n","\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 1146/1146 [10:40<00:00,  1.79it/s, Epoch=10, LR=7.7e-6, Train_Auroc=0.996, Train_Loss=0.0187]\n","100%|██████████| 230/230 [01:09<00:00,  3.32it/s, Epoch=10, LR=7.7e-6, Valid_Auroc=0.00436, Valid_Loss=0.0041]\n"]},{"output_type":"stream","name":"stdout","text":["\n","Training complete in 2h 0m 32s\n","Best AUROC: 0.9998\n","Best Loss: 0.0186\n"]}]},{"cell_type":"code","source":["history = pd.DataFrame.from_dict(history)\n","history.to_csv(\"history.csv\", index=False)"],"metadata":{"id":"NltcbvKEw4wm","papermill":{"duration":3.317792,"end_time":"2024-08-08T06:07:28.052411","exception":false,"start_time":"2024-08-08T06:07:24.734619","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# <span><h1 style = \"font-family: garamond; font-size: 40px; font-style: normal; letter-spcaing: 3px; background-color: #f6f5f5; color :#fe346e; border-radius: 100px 100px; text-align:center\">Logs</h1></span>"],"metadata":{"id":"PMUc0rhKw4wm","papermill":{"duration":3.370339,"end_time":"2024-08-08T06:07:34.686239","exception":false,"start_time":"2024-08-08T06:07:31.3159","status":"completed"},"tags":[]}},{"cell_type":"code","source":["plt.plot( range(history.shape[0]), history[\"Train Loss\"].values, label=\"Train Loss\")\n","plt.plot( range(history.shape[0]), history[\"Valid Loss\"].values, label=\"Valid Loss\")\n","plt.xlabel(\"epochs\")\n","plt.ylabel(\"Loss\")\n","plt.grid()\n","plt.legend()\n","plt.show()"],"metadata":{"id":"eKWB6zkIw4wm","papermill":{"duration":3.535561,"end_time":"2024-08-08T06:07:41.524938","exception":false,"start_time":"2024-08-08T06:07:37.989377","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":449},"executionInfo":{"status":"ok","timestamp":1724454941259,"user_tz":-120,"elapsed":401,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"84b3139d-59c8-4305-8d8a-817d17b224ad"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"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ISGB+vXrs3jx4uyJ0XFxcTmG644cOUKDBg2yn7/33nu89957tGnThuXLlwPwySefAM6hukt9+eWXDBgwIF/351ra1wqheuli7E46x9e/xfFMx5qG1iMi4k7SbFnUHv2zIZ+9/T+d8PXMm1+5L7zwAu+99x6VK1emePHixMfH06VLF9544w28vLyYNm0ad999N7t27aJChQpX3M6YMWN45513ePfdd/noo4948MEHOXjw4FXPmr6SmJgYevXqxauvvkrv3r1Zu3YtTz75JCVKlGDAgAFs2rSJp59+mq+//pqWLVty8uRJVq1aBThHvfr27cs777zDvffey9mzZ1m1atV1h8abZfgk6GHDhuUY0rvUxVBzUXh4+DW/kPz+wm6F2Wzi8TaViPruD75aF8eQNlXx8zK8C0REpBB59dVX6dChQ/bz4OBgIiMjs5+/9tprzJ07l/nz51/x9yvAgAED6Nu3LwBvvvkmH374IRs2bKBz5843XNP777/PHXfcwcsvvwxA9erV2b59O++++y4DBgwgLi4OPz8/7rrrLvz9/alYsWL2gMbRo0fJzMykR48eVKxYEYCIiIgbruFG6bdvAetSN5Sx//udY2k2vl1/kCG3VzG6JBERt+BjtbD9P50M++y80rhx4xzPz507x6uvvsrChQuzw0RaWhpxcXFX3U69evWyH/v5+REQEHDFOzFcy44dO+jWrVuOda1atWL8+PFkZWXRoUMHKlasSOXKlencuTOdO3fOPvwWGRnJHXfcQUREBJ06daJjx47cf//9FC9e/KZquV6ajVvALGYT7cs5L2A1ZdV+ztuyDK5IRMQ9mEwmfD09DFny8mrUfn5+OZ4/++yzzJ07lzfffJNVq1YRGxtLRETENa999M8zpkwmU75dYNHf35/NmzczY8YMypQpw+jRo4mMjOT06dNYLBaio6P56aefqF27Nh999BE1atRg//79+VLLRQpABmhc0kGZQG+OnU3nu03xRpcjIiKF2Jo1axgwYAD33nsvERERhIaGcuDAgQKtoVatWqxZs+ayuqpXr559tWYPDw/at2/PO++8w++//86BAwf49ddfAWf4atWqFWPGjGHLli14enoyd+7cfK1Zh8AM4GGGR1uH85+FO5m04i/6NK2A1aIsKiIiN65atWr88MMP3H333ZhMJl5++eV8G8k5duwYsbGxOdaVKVOGf/3rXzRp0oTXXnuN3r17s27dOiZMmMDHH38MwIIFC/jrr7+4/fbbKV68OIsWLcJut1OjRg3Wr1/P0qVL6dixI6VLl2b9+vUcO3aMWrVq5cs+XKTfugbp2agcJYt5cfh0GvO2HDa6HBERKaTef/99ihcvTsuWLbn77rvp1KkTDRs2zJfPmj59Og0aNMixTJkyhYYNGzJ79mxmzpxJ3bp1GT16NP/5z3+yz74OCgrihx9+4P/+7/+oVasWkyZNYsaMGdSpU4eAgABWrlxJly5dqF69Oi+99BLjxo3jzjvvzJd9uMjkcOXTpgySnJxMYGAgZ86cyZdbYSxatIguXbrw+do43vppJ5VL+hEd1QaLWXcsLmiX9kdhvNJtUaP+cC2FvT/Onz/P/v37qVSpUpG4FYbdbic5OZmAgIBCc2Xr/HC1fr2R39/u+w26gIeaVyTQx8pfx1P4adtRo8sRERFxGwpABirm5cGAluEATFy2z6WvYSQiIlKUKAAZbGCrcPw8Lew4msyvO2/u+gsiIiJyYxSADBbk68lDzZ1XvpywbK9GgURERAqAApALGHxbJbw8zGyJO826fSeMLkdERKTIUwByAaX9venTJAyAj37de43WIiIicqsUgFzEkDZV8DCbWPfXCWIOnjK6HBERkSJNAchFlAvyoUfDcgBMXKZRIBERkfykAORCnmhbFbMJft2ZxJ9HzhhdjoiIFFJt27ZlxIgR2c/Dw8MZP378Vd9jMpmYN29evtblShSAXEilkn50rVcWgI+X7TO4GhERKWh33303nTt3zvW1VatWUbx4cX7//fcb3u7GjRsZMmTILdU2YMAAunfvfkvbcCUKQC5maLsqACzadpS9SecMrkZERArS4MGDiY6O5tChQ5e9NnXqVBo0aEC9evVueLulSpXC19c3L0osMhSAXEzN0ADa1wrB4YBPlmsUSETEndx1112UKlWKqVOn5lh/7tw55syZw0MPPcSJEyfo27cv5cqVw9fXl4iICGbMmHHV7f7zENiePXu4/fbb8fb2pnbt2kRHR99y7StWrKBp06Z4eXlRpkwZnn/+eTIzM7NfnzNnDhEREfj4+FCiRAnat29PSkoKAMuXL6dp06b4+fkRFBREq1atOHjw4C3XdDUKQC5o2P9VBWBe7GHiT6YaXI2ISBHhcEBGijHLdV7k1sPDg379+jF16tQcF8b97rvvyMrK4r777uP8+fM0atSIhQsXsm3bNoYMGcLDDz/Mhg0brusz7HY7PXr0wNPTk/Xr1zNp0iSee+65m/pKLzp8+DBdunShSZMmbN26lU8++YTPP/+c119/HYCjR4/St29fBg0axI4dO1i+fDk9evTA4XCQmZlJ9+7dadOmDb///jvr1q1jyJAhmEz5e4Nwj3zdutyU+mFBtK5aktV7j/Ppyn283j3C6JJERAo/Wyq8WdaYz37hCHj6XVfTQYMG8e6777JixQratm0LwJdffkmPHj0IDAwkICCAZ599Nrv9U089xc8//8zs2bNp2rTpNbf/yy+/sHPnTn7++WfKlnV+H2+++SZ33nnnje/XBR9//DFhYWFMmDABk8lEzZo1OXLkCM899xyjR4/m6NGjZGZm0qNHDypWdN79ICLC+bvt5MmTnDlzhrvuuosqVZzTQGrVqnXTtVwvjQC5qKHtnKNAszcdIin5vMHViIhIQalZsyYtW7bkiy++AGDv3r2sWrWKQYMGAZCVlcVrr71GREQEwcHBFCtWjJ9//pm4uLjr2v6OHTsICwvLDj8ALVq0uKWad+zYQYsWLXKM2rRq1Ypz585x6NAhIiMjueOOO4iIiKBnz55MmTKFU6ec17wLDg5mwIABdOrUibvvvpsPPviAo0eP3lI910MjQC6qeeVgGlcszqaDp5iy6i9e7Frb6JJERAo3q69zJMaoz74BgwcP5qmnnmLixIl8+eWXVKlShTZt2nD27Fnee+89PvjgA8aPH09ERAR+fn6MGDGCjIyMfCr+1lksFqKjo1m7di1Llizho48+4sUXX2T9+vVUqlSJL7/8kqeffprFixcza9YsXnrpJaKjo2nevHm+1aQRIBdlMpkYemEu0De/xXEyxXV/sEVECgWTyXkYyojlBuez9OrVC7PZzPTp05k2bRqDBg3KHl1Zs2YN3bp146GHHiIyMpLKlSuze/fu6952rVq1iI+PzzHK8ttvv91Qfbltc926dTnmLa1ZswZ/f3/Kly8POH+vtWrVijFjxrBlyxY8PT2ZO3dudvsGDRowatQo1q5dS926dZk+ffot1XQtCkAurG31UtQtF0CaLYsv1+w3uhwRESkgxYoVo3fv3owaNYqjR48yYMCA7NeqVauWPZqyY8cOHnvsMRITE6972+3bt6d69er079+frVu3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utoZfisMERERkYKmACQiIiJuRwGogHl5efHKK6/keuFFKXjqD9ei/nAt6g/Xov7IW5oELSIiIm5HI0AiIiLidhSARERExO0oAImIiIjbUQASERERt6MAVIAmTpxIeHg43t7eNGvWjA0bNhhdklsaO3YsTZo0wd/fn9KlS9O9e3d27dpldFlywVtvvZV9U2MxzuHDh3nooYcoUaIEPj4+REREsGnTJqPLcktZWVm8/PLLVKpUCR8fH6pUqcJrr712Xfe7kitTACogs2bNIioqildeeYXNmzcTGRlJp06dSEpKMro0t7NixQqGDh3Kb7/9RnR0NDabjY4dO5KSkmJ0aW5v48aNfPrpp9SrV8/oUtzaqVOnaNWqFVarlZ9++ont27czbtw4ihcvbnRpbuntt9/mk08+YcKECezYsYO3336bd955h48++sjo0go1nQZfQJo1a0aTJk2YMGEC4LzfWFhYGE899RTPP/+8wdW5t2PHjlG6dGlWrFjB7bffbnQ5buvcuXM0bNiQjz/+mNdff5369eszfvx4o8tyS88//zxr1qxh1apVRpciwF133UVISAiff/559rr77rsPHx8fvvnmGwMrK9w0AlQAMjIyiImJoX379tnrzGYz7du3Z926dQZWJgBnzpwBIDg42OBK3NvQoUPp2rVrjr8nYoz58+fTuHFjevbsSenSpWnQoAFTpkwxuiy31bJlS5YuXcru3bsB2Lp1K6tXr+bOO+80uLLCTTdDLQDHjx8nKyuLkJCQHOtDQkLYuXOnQVUJOEfiRowYQatWrahbt67R5bitmTNnsnnzZjZu3Gh0KQL89ddffPLJJ0RFRfHCCy+wceNGnn76aTw9Penfv7/R5bmd559/nuTkZGrWrInFYiErK4s33niDBx980OjSCjUFIHFrQ4cOZdu2baxevdroUtxWfHw8w4cPJzo6Gm9vb6PLEZz/MWjcuDFvvvkmAA0aNGDbtm1MmjRJAcgAs2fP5ttvv2X69OnUqVOH2NhYRowYQdmyZdUft0ABqACULFkSi8VCYmJijvWJiYmEhoYaVJUMGzaMBQsWsHLlSsqXL290OW4rJiaGpKQkGjZsmL0uKyuLlStXMmHCBNLT07FYLAZW6H7KlClD7dq1c6yrVasW33//vUEVubeRI0fy/PPP06dPHwAiIiI4ePAgY8eOVQC6BZoDVAA8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\n"},"metadata":{}}]},{"cell_type":"code","source":["plt.plot( range(history.shape[0]), history[\"Train AUROC\"].values, label=\"Train AUROC\")\n","plt.plot( range(history.shape[0]), history[\"Valid AUROC\"].values, label=\"Valid AUROC\")\n","plt.xlabel(\"epochs\")\n","plt.ylabel(\"AUROC\")\n","plt.grid()\n","plt.legend()\n","plt.show()"],"metadata":{"id":"-NuL9qi3w4wm","papermill":{"duration":3.653158,"end_time":"2024-08-08T06:07:48.462548","exception":false,"start_time":"2024-08-08T06:07:44.80939","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":449},"executionInfo":{"status":"ok","timestamp":1724454941259,"user_tz":-120,"elapsed":9,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"b27f2e38-d5bd-40e4-b04e-ef3e0e34cf3a"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"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AACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYCuEGAACYit/DzbRp09SgQQOFhYWpU6dOWrNmzXmXT09PV9OmTRUeHq7Y2FiNHDlSJ0+evETVAgCAQOfXcDN37lwlJydr3Lhx2rBhg9q0aaPExETt27fP6/KzZ89WSkqKxo0bp5ycHGVkZGju3LkaPXr0Ja4cAAAEqiB/bnzKlCl64IEHdN9990mSZsyYoQULFmjmzJlKSUkptfw333yjrl276u6775YkNWjQQP3799e33357zm0UFBSooKDAPW232yVJDodDDofDly/H3Z+v+8WFYTwCC+MRWBiPwMOYnF953he/hZvCwkKtX79eqamp7jar1ar4+HitWrXK6zpdunTRv/71L61Zs0YdO3bUzz//rIULF+qee+4553bS0tI0fvz4Uu1LlixRRETExb8QLzIzMyukX1wYxiOwMB6BhfEIPIyJd8ePHy/zsn4LNwcOHJDT6VR0dLRHe3R0tLZu3ep1nbvvvlsHDhzQn/70JxmGoaKiIv39738/72Gp1NRUJScnu6ftdrtiY2PVo0cPRUVF+ebFnOJwOJSZmamEhAQFBwf7tG+UH+MRWBiPwMJ4BB7G5PxKjryUhV8PS5XX8uXLNWHCBE2fPl2dOnXSjh079Nhjj+n555/XM88843Wd0NBQhYaGlmoPDg6usF+eiuwb5cd4BBbGI7AwHoGHMfGuPO+J38JNrVq1ZLPZlJeX59Gel5enmJgYr+s888wzuueee3T//fdLklq1aqX8/Hw9+OCDGjNmjKxWv3/5CwAA+Jnf0kBISIjatWunrKwsd5vL5VJWVpY6d+7sdZ3jx4+XCjA2m02SZBhGxRULAAAuG349LJWcnKykpCS1b99eHTt2VHp6uvLz893fnho0aJDq16+vtLQ0SVKvXr00ZcoUXXfdde7DUs8884x69erlDjkAAKBy82u46du3r/bv36+xY8cqNzdXbdu21aJFi9wnGe/evdtjT83TTz8ti8Wip59+Wnv27FHt2rXVq1cvvfjii/56CQAAIMD4/YTiYcOGadiwYV7nLV++3GM6KChI48aN07hx4y5BZQAA4HLEGbgAAMBUCDcAAMBUCDcA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ww03KCQkRDNmzFCLFi20a9cuPf300+rQoYNWrVqla665RlJxYOratauqV6+uSZMmqVWrVnI4HFq8eLGGDh2qrVu3+uT1e1PmPTdVq1bV119/rYEDB2ru3LkaOXKkRo4cqblz52rgwIH66quvVLVq1QorFACASy0mJsb9qFatmiwWi3t669atqlq1qj7//HO1a9dOoaGh+uqrr/TTTz/pL3/5i6KjoxUZGakOHTpo6dKlHv2efVjKYrHo7bff1sCBAxUZGanGjRtr/vz5f1jfzp079c033yglJUVNmjTRv//974t6vTVr1lRMTIxatmyp0aNHy26369tvv3XPHzNmjPbu3aulS5fq1ltv1VVXXaUbb7xRixcvVnBwsMfeo0ceeUQWi0Vr1qxR79691aRJE7Vo0ULJyckVfgPscn2Rvlq1apo+fboOHDigvLw85ebm6vfff9f06dN1xRVXVFSNAAATMgxDxwuL/PIwDMNnryMlJUUTJ05UTk6OWrdurWPHjqlnz57KysrSd999p1tuuUW9evXyetjmTM8//7zuuOMOZWdnq2fPnhowYIAOHjx43nXeeecd3XbbbapWrZoGDhyojIwMn7ymEydO6N1335V0+uvZLpdLc+bM0YABAxQTE+OxfHh4uB555BEtXrxYBw8e1MGDB7Vo0SINHTpUVapUKdX/uQ6V+coF3X5h06ZN2r59uySpadOmatWqlU+LAgCY3wmHU83HLvbLtrc8l6iIEN/cgei5555TQkKCe7pGjRpq06aNe/r555/XvHnzNH/+fA0bNuyc/SQlJenOO+9UVFSUJkyYoFdffVVr1qzRLbfc4nV5l8ulWbNm6bXXXpMk9evXT48//rh27typhg0bXtBr6dKli6xWq44fPy7DMNSuXTvdfPPNkqT9+/fr8OHDiouL87puXFycDMPQjh07JBWH12bNml1QHRerXHtu1qxZo1atWum6665Tnz591KdPH7Vt21atW7fW2rVrK6pGAAACVvv27T2mjx07pieeeEJxcXGqXr26IiMjlZOT84d7bs7cUVClShVFRUVp375951w+MzNT+fn56tmzpySpVq1aSkhI0MyZMy/4tcydO1ffffedPv74YzVq1EizZs0qdaXgsuz18uWesQtR5ti6ZcsW3XzzzYqLi9O//vUvd3LbsmWLXnnlFd18881avXq1mjdvXmHFAgDMIzzYpi3PJfpt275y9mGXJ554QpmZmXr55ZfVqFEjhYeH684771RhYeF5+zk7RFgsFrlcrnMun5GRoYMHDyo8PNzd5nK59P3332v8+PGyWq2KiopSfn6+XC6Xxy0dSm5eWq1aNY8+Y2Nj1bhxYzVu3FhFRUX661//qs2bNys0NFS1a9dW9erVlZOT47WenJwcWSwWNWrUyF1/RZ40fD5l3nPz7LPPKiEhQd9++6369++vtm3bqm3btrr77ru1Zs0a3XzzzRf8lTgAQOVjsVgUERLkl0dFXin566+/1r333qu//vWvatWqlWJiYrRr1y6fbuP333/Xp59+qjlz5ig7O9v9+O6773To0CEtWbJEUvGpI0VFRcrOzvZYf8OGDZKkJk2anHMbd955p4KCgjR9+nRJxXfs7tOnj2bPnq3c3FyPZU+cOKHp06crMTFRNWrUUI0aNZSYmKhp06YpPz+/VN8VfWf4MoebZcuWafTo0V5/ISwWi0aPHq1ly5b5tDgAAC43jRs31r///W9lZ2dr48aNuvvuu8+7B+ZC/L//9/9Us2ZN9enTRy1btnQ/2rRpo549e7pPLG7RooV69OihwYMHKysrSzt37tSiRYv0yCOPqG/fvqpfv/45t2GxWPToo49q4sSJOn78uCRpwoQJiomJUUJCgj7//HP98ssvWrlypRITE+VwODRt2jT3+tOmTZPT6VTHjh318ccf68cff1ROTo5effVVde7c2afvx9nKHG6OHj3q/p67NzExMTp69KhPigIA4HI1ZcoUXXHFFerSpYt69eqlxMREXX/99T7dxsyZM/XXv/7V6w6H3r17a/78+Tpw4ICk4vNobrrpJj300ENq0aKFHn30Uf3lL3/R22+//YfbSUpKksPhcN8Yu2bNmlq9erW6d++uhx56SNdee6369Omja6+9VmvXrnVf40aSrrnmGm3YsEHdu3fX448/rpYtWyohIUFZWVl6/fXXffROeGcxynjWT9OmTTVhwoRzXoX4o48+0pgxYzwubhSI7Ha7qlWrpiNHjigqKsqnfTscDi1cuFA9e/a8qFu1wzcYj8DCeASWSz0eJ0+edH+L52IuMmdmLpdLdrtdUVFRHufHVCbn+z0pz+d3md+9fv36KTk5WZs3by41b9OmTXriiSfUt2/fsnYHAABQIcr8banU1FQtXbpUbdu2VUJCgvv77Dk5OVq6dKk6duyo0aNHV2StAAAAf6jM4SYsLEzLli3TK6+8ovfff18rVqyQVHym9QsvvKCRI0cqNDS0wgoFAAAoi3JdnjEkJESjRo3SqFGjKqoeAACAi+KzM5Z+++23815WGgAA4FIo156bH374QcuWLVNISIj69Omj6tWr68CBA3rhhRf0xhtveHwFDAAAwB/KvOdm/vz5uu666/Too4/q73//u9q3b69ly5YpLi5OW7du1bx58/TDDz9UZK0AAAB/qMzh5oUXXtDQoUNlt9s1ZcoU/fzzz3r00Ue1cOFCLVq06Jx3LQUAALiUyhxutm3bpqFDhyoyMlLDhw+X1WrVK6+8og4dOlRkfQAAAOVSrtsvlFwR0GazKTw8nHNsAAAog27dumnEiBHu6QYNGig9Pf2861gsFn3yyScVWpdZlevbUosXL9b8+fM1f/58uVwuZWVluadLHgAAmEWvXr3OedrFl19+KYvFou+//77c/a5du1YPPvjgxZYnSVq1apVsNptuu+22UvOWL18ui8Xi9S7cZwcsi8XifkRFRalDhw769NNPS6134sQJjRs3Tk2aNFFoaKhq1aqlu+66y+t5t3a7XWPGjFGzZs0UFhammJgYxcfH69///rfKePenC1Kub0slJSV5TD/00EMe0xaLRU6n8+KrAgAgAAwZMkS9e/fWr7/+qiuvvNJj3jvvvKP27durdevW5e63du3avipRGRkZGj58uDIyMrR3717Vq1fvgvt65513dMstt8hut2v69Om68847tWHDBrVq1UqSVFBQoPj4eO3evVuTJ09Wp06dlJeXp7S0NHXq1ElLly7VDTfcIEk6fPiw/vSnP+nIkSN64YUX1KFDBwUFBWnFihV66qmn9D//8z+qXr26L96CUsq858blcv3hg2ADADCT22+/XbVr19asWbM82o8dO6YPP/xQQ4YM0e+//67+/furfv36ioiIUKtWrfT++++ft9+z95r8+OOP6tatm2JiYtSyZUtlZmaWqb5jx45p7ty5evjhh3XbbbeVqrO8qlevrpiYGDVp0kTPP/+8ioqKtGzZMvf89PR0rVq1Sp999pn69Omjq6++Wh07dtTHH3+suLg4DRkyxL1HZvTo0dq1a5e+/fZbJSUlqXnz5mrSpIkeeOABZWdnKzIy8qJqPZ/KedtRAID/GYZUmO+f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aZXe2rVr9cYbb6h169b+LqXSOnTokLp27arg4GB9/vnn2rJliyZPnqwrrrjC36VVSi+99JJef/11TZ06VTk5OXrppZf0j3/8Q6+99pq/S7us8VVwH+jUqZM6dOigqVOnSiq+f1VsbKyGDx+ulJQUP1eH/fv3q06dOlqxYoVuvPFGf5dTaR07dkzXX3+9pk+frhdeeEFt27ZVenq6v8uqdFJSUvT111/ryy+/9HcpkHT77bcrOjpaGRkZ7rbevXsrPDxc//rXv/xY2eWNPTcXqbCwUOvXr1d8fLy7zWq1Kj4+XqtWrfJjZShx5MgRSVKNGjX8XEnlNnToUN12220e/1Zw6c2fP1/t27fXXXfdpTp16ui6667TW2+95e+yKq0uXbooKytL27dvlyRt3LhRX331lW699VY/V3Z5q3Q3zvS1AwcOyOl0Kjo62qM9OjpaW7du9VNVKOFyuTRixAh17dpVLVu29Hc5ldacOXO0YcMGrV271t+lVHo///yzXn/9dSUnJ2v06NFau3atHn30UYWEhCgpKcnf5VU6KSkpstvtatasmWw2m5xOp1588UUNGDDA36Vd1gg3MLWhQ4dq8+bN+uqrr/xdSqX1yy+/6LHHHlNmZqbCwsL8XU6l53K51L59e02YMEGSdN1112nz5s2aMWMG4cYPPvjgA7333nuaPXu2WrRooezsbI0YMUL16tVjPC4C4eYi1apVSzabTXl5eR7teXl5iomJ8VNVkKRhw4bps88+08qVK3XllVf6u5xKa/369dq3b5+uv/56d5vT6dTKlSs1depUFRQUyGaz+bHCyqVu3bpq3ry5R1tcXJw+/vhjP1VUuT355JNKSUlRv379JEmtWrXSf//7X6WlpRFuLgLn3FykkJAQtWvXTllZWe42l8ulrKwsde7c2Y+VVV6GYWjYsGGaN2+evvjiCzVs2NDfJVVqN998szZt2qTs7Gz3o3379howYICys7MJNpdY165dS10aYfv27br66qv9VFHldvz4cVmtnh/FNptNLpfLTxWZA3tufCA5OVlJSUlq3769OnbsqPT0dOXn5+u+++7zd2mV0tChQzV79mx9+umnqlq1qnJzcyVJ1apVU3h4uJ+rq3yqVq1a6nynKlWqqGbNmpwH5QcjR45Uly5dNGHCBPXp00dr1qzRm2++qTfffNPfpVVKvXr10osvvqirrrpKLVq00HfffacpU6Zo8ODB/i7tssZXwX1k6tSpmjRpknJzc9W2bVu9+uqr6tSpk7/LqpQsFovX9nfeeUf33nvvpS0GXnXr1o2vgvvRZ599ptTUVP34449q2LChkpOT9cADD/i7rErp6NGjeuaZZzRv3jzt27dP9erVU//+/TV27FiFhIT4u7zLFuEGAACYCufcAAAAUyHcAAAAUyHcAAAAUyHcAAAAUyHcAAAAUyHcAAAAUyHcAAAAUyHcAAAAUyHcAKh0li9fLovFosOHD/u7FAAVgHADAABMhXADAABMhXAD4JJzuVxKS0tTw4YNFR4erjZt2uijjz6SdPqQ0YIFC9S6dWuFhYXphhtu0ObNmz36+Pjjj9WiRQuFhoaqQYMGmjx5ssf8goICjRo1SrGxsQoNDVWjRo2UkZHhscz69evVvn17RUREqEuXLtq2bZt73saNG9W9e3dVrVpVUVFRateundatW1dB7wgAXyLcALjk0tLS9O6772rGjBn64YcfNHLkSA0cOFArVqxwL/Pkk09q8uTJWrt2rWrXrq1evXrJ4XBIKg4lffr0Ub9+/bRp0yY9++yzeuaZZzRr1iz3+oMGDdL777+vV199VTk5OXrjjTcUGRnpUceYMWM0efJkrVu3TkFBQRo8eLB73oABA3TllVdq7dq1Wr9+vVJSUhQcHFyxbwwA3zAA4BI6efKkERERYXzzzTce7UOGDDH69+9vLFu2zJBkzJkzxz3v999/N8LDw425c+cahmEYd999t5GQkOCx/pNPPmk0b97cMAzD2LZtmyHJyMzM9FpDyTaWLl3qbluwYIEhyThx4oRhGIZRtWpVY9asWRf/ggFccuy5AXBJ7dixQ8ePH1dCQoIiIyPdj3fffVc//fSTe7nOnTu7n9eoUUNNmzZVTk6OJCknJ0ddu3b16Ldr16768ccf5XQ6lZ2dLZvNpptuuum8tbRu3dr9vG7dupKkffv2SZKSk5N1//33Kz4+XhMnTvSoDUBgI9wAuKSOHTsmSVqwYIGys7Pdjy1btrjPu7lY4eHhZVruzMNMFotFUvH5QJL07LPP6ocfftBtt92mL774Qs2bN9e8efN8Uh+AikW4AXBJNW/eXKGhodq9e7caNWrk8YiNjXUvt3r1avfzQ4cOafv27YqLi5MkxcXF6euvv/bo9+uvv1aTJk1ks9nUqlUruVwuj3N4LkSTJk00cuRILVmyRH/729/0zjvvXFR/AC6NIH8XAKByqVq1qp544gmNHDlSLpdLf/rTn3TkyBF9/fXXioqK0tVXXy1Jeu6551SzZk1FR0drzJgxqlWrlu644w5J0uOPP64OHTro+eefV9++fbVq1SpNnTpV06dPlyQ1aNBASUlJGjx4sF599VW1adNG//3vf7Vv3z716dPnD2s8ceKEnnzySd15551q2LChfv31V61du1a9e/eusPcFgA/5+6QfAJWPy+Uy0tPTjaZNmxrBwcFG7dq1jcTERGPFihXuk33/85//GC1atDBCQkKMjh07Ghs3bvTo46OPPjKaN29uBAcHG1dddZUxadIkj/knTpwwRo4cadStW9cICQkxGjVqZMycOdMwjNMnFB86dMi9/HfffWdIMnbu3GkUFBQY/fr1M2JjY42QkBCjXr16xrBhw9wnGwMIbBbDMAw/5ysAcFu+fLm6d++uQ4cOqXr16v4uB8BliHNuAACAqRBuAACAqXBYCgAAmAp7bgAAgKkQbgAAgKkQbgAAgKkQbgAAgKkQbgAAgKkQbgAAgKkQbgAAgKkQbgAAgKn8f4a3XMFHUXkOAAAAAElFTkSuQmCC\n"},"metadata":{}}]},{"cell_type":"code","source":["plt.plot( range(history.shape[0]), history[\"lr\"].values, label=\"lr\")\n","plt.xlabel(\"epochs\")\n","plt.ylabel(\"lr\")\n","plt.grid()\n","plt.legend()\n","plt.show()"],"metadata":{"id":"Uj5fTuJQw4wm","papermill":{"duration":3.533189,"end_time":"2024-08-08T06:07:55.348307","exception":false,"start_time":"2024-08-08T06:07:51.815118","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":465},"executionInfo":{"status":"ok","timestamp":1724454941606,"user_tz":-120,"elapsed":355,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"b5f5acd7-cf1d-4c44-cb4d-f1d109b58d2e"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"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iIjwTps27dq/YQCljjMqAIps586dys7OVrdu3VSmTJn8j+nTp2vXrl35z2vfvn3+f5cvX17169fXli1bJElbtmxRx44dCxy3Y8eO2rFjh9xut9auXSubzabrrrvuslmaNWuW/9+VK1eWJKWkpEiSRowYoYceekhdu3bVG2+8USAbAHOjqAAosszMTEnSnDlztHbt2vyPzZs358+pXKvQ0NCret75WzkWi0XS2fkZSRo1apQ2bdqk7t2769dff1WjRo00a9asYskHoGRRVAAUWaNGjeRwOLR//37VrVu3wEdcXFz+81asWJH/32lpadq+fbsaNmwoSWrYsKGWLl1a4LhLly5VfHy8bDabmjZtKo/HU2DmpSji4+M1fPhw/fLLL7rrrrs0derUazoegNIRZHQAAL4rIiJCTz/9tIYPHy6Px6NOnTopPT1dS5cuVWRkpGrUqCFJevnllxUdHa2KFSvq+eefV0xMjHr27ClJeuqpp9SmTRu98soruvfee7V8+XJNmDBB7777riSpZs2a6t+/vwYNGqRx48apefPm2rdvn1JSUtSrV68rZjxz5oyeeeYZ/eUvf1GtWrV08OBBJSUl6e677y6xnwuAYmT0kAwA3+bxeLzvvPOOt379+l673e6NjY313nzzzd6FCxfmD7p+//333saNG3uDg4O9iYmJ3nXr1hU4xldffeVt1KiR1263e6tXr+596623Cnz+zJkz3uHDh3srV67sDQ4O9tatW9f70Ucfeb3e/w3TpqWl5T9/zZo1XknePXv2eJ1Op7d3797euLg4b3BwsLdKlSreIUOG5A/aAjA3i9fr9RrclQD4qQULFqhLly5KS0tTVFSU0XEA+CBmVAAAgGlRVAAAgGmx9QMAAEyLMyoAAMC0KCoAAMC0KCoAAMC0KCoAAMC0KCoAAMC0KCoAAMC0KCoAAMC0KCoAAMC0KCoAAMC0/j9s3jE3x3gzEgAAAABJRU5ErkJggg==\n"},"metadata":{}}]},{"cell_type":"code","source":["torch.save(model, path_isic_data+\"zinneke_picture.pt\")"],"metadata":{"id":"uzQ0qOv41Naa"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model = torch.load(path_isic_data+\"zinneke_picture.pt\")"],"metadata":{"id":"so5FR3dF1Naq"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# INFERENCE THREE TEST EXAMPLES"],"metadata":{"id":"poBXfFf0PrFK","papermill":{"duration":3.270445,"end_time":"2024-08-08T06:08:01.934219","exception":false,"start_time":"2024-08-08T06:07:58.663774","status":"completed"},"tags":[]}},{"cell_type":"code","source":["test_post_dataset = ISICDataset_for_Test(subm_data, TEST_HDF, transforms=data_transforms[\"valid\"])\n","test_post_loader = DataLoader(test_post_dataset, batch_size=CONFIG['valid_batch_size'],\n","                          num_workers=2, shuffle=False, pin_memory=True)"],"metadata":{"id":"wenCNmX25tMZ","papermill":{"duration":3.327282,"end_time":"2024-08-08T06:08:08.620166","exception":false,"start_time":"2024-08-08T06:08:05.292884","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## start inference"],"metadata":{"papermill":{"duration":3.243046,"end_time":"2024-08-08T06:08:15.106851","exception":false,"start_time":"2024-08-08T06:08:11.863805","status":"completed"},"tags":[],"id":"9Jh7HiDvMQwo"}},{"cell_type":"code","source":["preds_test = []\n","with torch.no_grad():\n","    bar = tqdm(enumerate(test_post_loader), total=len(test_post_loader))\n","    for step, data in bar:\n","        images = data['image'].to(CONFIG[\"device\"], dtype=torch.float)\n","        batch_size =  images.size(0)\n","        outputs = model(images)\n","        preds_test.append( outputs.detach().cpu().numpy() )\n","preds_test = np.concatenate(preds_test).flatten()"],"metadata":{"id":"JkbMiY6fPrFV","papermill":{"duration":3.741433,"end_time":"2024-08-08T06:08:22.173626","exception":false,"start_time":"2024-08-08T06:08:18.432193","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724454943796,"user_tz":-120,"elapsed":1706,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"5e94996e-534b-4495-8ee7-29d44a33a23f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 1/1 [00:01<00:00,  1.42s/it]\n"]}]},{"cell_type":"code","source":["# Assign predictions to submission DataFrame # this seems correct\n","subm_data[\"preds\"] = preds_test\n","display(subm_data.head())"],"metadata":{"id":"u_StnHmnPrFV","papermill":{"duration":3.27493,"end_time":"2024-08-08T06:08:28.717104","exception":false,"start_time":"2024-08-08T06:08:25.442174","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":332},"executionInfo":{"status":"ok","timestamp":1724454943796,"user_tz":-120,"elapsed":12,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"d9464d43-851f-459b-bce3-9453546b7f7f"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["        isic_id  patient_id  age_approx     sex anatom_site_general  \\\n","0  ISIC_0015657  IP_6074337        45.0    male     posterior torso   \n","1  ISIC_0015729  IP_1664139        35.0  female     lower extremity   \n","2  ISIC_0015740  IP_7142616        65.0    male     posterior torso   \n","\n","   clin_size_long_diam_mm          image_type tbp_tile_type  tbp_lv_A  \\\n","0                    2.70  TBP tile: close-up        3D: XP  22.80433   \n","1                    2.52  TBP tile: close-up        3D: XP  16.64867   \n","2                    3.16  TBP tile: close-up        3D: XP  24.25384   \n","\n","   tbp_lv_Aext  ...  tbp_lv_stdLExt  tbp_lv_symm_2axis  \\\n","0    20.007270  ...        2.299935           0.479339   \n","1     9.657964  ...        2.011223           0.426230   \n","2    19.937380  ...        2.705857           0.366071   \n","\n","   tbp_lv_symm_2axis_angle   tbp_lv_x     tbp_lv_y    tbp_lv_z  \\\n","0                       20 -155.06510  1511.222000  113.980100   \n","1                       25 -112.36924   629.535889  -15.019287   \n","2                      110  -84.29282  1303.978000  -28.576050   \n","\n","                                         attribution  copyright_license  \\\n","0             Memorial Sloan Kettering Cancer Center              CC-BY   \n","1  Frazer Institute, The University of Queensland...              CC-BY   \n","2                                        FNQH Cairns              CC-BY   \n","\n","   target     preds  \n","0       0  0.000003  \n","1       0  0.000003  \n","2       0  0.001194  \n","\n","[3 rows x 46 columns]"],"text/html":["\n","  <div id=\"df-9e11c5b1-e26b-41a6-b789-a0446a6cbfa8\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>isic_id</th>\n","      <th>patient_id</th>\n","      <th>age_approx</th>\n","      <th>sex</th>\n","      <th>anatom_site_general</th>\n","      <th>clin_size_long_diam_mm</th>\n","      <th>image_type</th>\n","      <th>tbp_tile_type</th>\n","      <th>tbp_lv_A</th>\n","      <th>tbp_lv_Aext</th>\n","      <th>...</th>\n","      <th>tbp_lv_stdLExt</th>\n","      <th>tbp_lv_symm_2axis</th>\n","      <th>tbp_lv_symm_2axis_angle</th>\n","      <th>tbp_lv_x</th>\n","      <th>tbp_lv_y</th>\n","      <th>tbp_lv_z</th>\n","      <th>attribution</th>\n","      <th>copyright_license</th>\n","      <th>target</th>\n","      <th>preds</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ISIC_0015657</td>\n","      <td>IP_6074337</td>\n","      <td>45.0</td>\n","      <td>male</td>\n","      <td>posterior torso</td>\n","      <td>2.70</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>22.80433</td>\n","      <td>20.007270</td>\n","      <td>...</td>\n","      <td>2.299935</td>\n","      <td>0.479339</td>\n","      <td>20</td>\n","      <td>-155.06510</td>\n","      <td>1511.222000</td>\n","      <td>113.980100</td>\n","      <td>Memorial Sloan Kettering Cancer Center</td>\n","      <td>CC-BY</td>\n","      <td>0</td>\n","      <td>0.000003</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ISIC_0015729</td>\n","      <td>IP_1664139</td>\n","      <td>35.0</td>\n","      <td>female</td>\n","      <td>lower extremity</td>\n","      <td>2.52</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>16.64867</td>\n","      <td>9.657964</td>\n","      <td>...</td>\n","      <td>2.011223</td>\n","      <td>0.426230</td>\n","      <td>25</td>\n","      <td>-112.36924</td>\n","      <td>629.535889</td>\n","      <td>-15.019287</td>\n","      <td>Frazer Institute, The University of Queensland...</td>\n","      <td>CC-BY</td>\n","      <td>0</td>\n","      <td>0.000003</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ISIC_0015740</td>\n","      <td>IP_7142616</td>\n","      <td>65.0</td>\n","      <td>male</td>\n","      <td>posterior torso</td>\n","      <td>3.16</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>24.25384</td>\n","      <td>19.937380</td>\n","      <td>...</td>\n","      <td>2.705857</td>\n","      <td>0.366071</td>\n","      <td>110</td>\n","      <td>-84.29282</td>\n","      <td>1303.978000</td>\n","      <td>-28.576050</td>\n","      <td>FNQH Cairns</td>\n","      <td>CC-BY</td>\n","      <td>0</td>\n","      <td>0.001194</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3 rows × 46 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9e11c5b1-e26b-41a6-b789-a0446a6cbfa8')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-9e11c5b1-e26b-41a6-b789-a0446a6cbfa8 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-9e11c5b1-e26b-41a6-b789-a0446a6cbfa8');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-8ed46714-737a-4fee-b06d-9a62d722a41f\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-8ed46714-737a-4fee-b06d-9a62d722a41f')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-8ed46714-737a-4fee-b06d-9a62d722a41f button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe"}},"metadata":{}}]},{"cell_type":"code","source":["subm_data.to_csv(path_isic_data+\"test_for_prediction.csv\", index=False)"],"metadata":{"id":"ENpB-RNa38N_","papermill":{"duration":4.770597,"end_time":"2024-08-08T06:30:05.983588","exception":false,"start_time":"2024-08-08T06:30:01.212991","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Assign predictions to submission DataFrame # this seems correct\n","subm_data[\"target\"] = preds_test\n"],"metadata":{"papermill":{"duration":3.27493,"end_time":"2024-08-08T06:08:28.717104","exception":false,"start_time":"2024-08-08T06:08:25.442174","status":"completed"},"tags":[],"trusted":true,"id":"O0tVgZoyMQwo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["subm_data = subm_data[['isic_id', 'target']]\n","subm_data.to_csv(path_isic_data+'submission.csv', index=False)\n","display(subm_data.head())"],"metadata":{"id":"H50CqlV_PrFV","papermill":{"duration":3.381316,"end_time":"2024-08-08T06:08:35.344422","exception":false,"start_time":"2024-08-08T06:08:31.963106","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":143},"executionInfo":{"status":"ok","timestamp":1724454944034,"user_tz":-120,"elapsed":247,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"d601d9a8-f141-4443-f1a7-1ac91b40af0a"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["        isic_id    target\n","0  ISIC_0015657  0.000003\n","1  ISIC_0015729  0.000003\n","2  ISIC_0015740  0.001194"],"text/html":["\n","  <div id=\"df-c9bd45aa-cba2-4fb6-a6c2-bdafa2c9b402\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>isic_id</th>\n","      <th>target</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ISIC_0015657</td>\n","      <td>0.000003</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ISIC_0015729</td>\n","      <td>0.000003</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ISIC_0015740</td>\n","      <td>0.001194</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c9bd45aa-cba2-4fb6-a6c2-bdafa2c9b402')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-c9bd45aa-cba2-4fb6-a6c2-bdafa2c9b402 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-c9bd45aa-cba2-4fb6-a6c2-bdafa2c9b402');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-7192db51-2060-4bb2-81ac-1e6ed9fed7cd\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-7192db51-2060-4bb2-81ac-1e6ed9fed7cd')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-7192db51-2060-4bb2-81ac-1e6ed9fed7cd button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"display(subm_data\",\n  \"rows\": 3,\n  \"fields\": [\n    {\n      \"column\": \"isic_id\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          \"ISIC_0015657\",\n          \"ISIC_0015729\",\n          \"ISIC_0015740\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"target\",\n      \"properties\": {\n        \"dtype\": \"float32\",\n        \"num_unique_values\": 3,\n        \"samples\": [\n          3.1761285299580777e-06,\n          2.629626351335901e-06,\n          0.0011941100237891078\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{}}]},{"cell_type":"markdown","source":[],"metadata":{"papermill":{"duration":3.25115,"end_time":"2024-08-08T06:08:41.87827","exception":false,"start_time":"2024-08-08T06:08:38.62712","status":"completed"},"tags":[],"id":"ZIG7ySUIMQwp"}},{"cell_type":"markdown","source":["# INFERENCE 2024 TRAIN SPLIT BEST AUC"],"metadata":{"id":"B_e2WpAn-ZxF","papermill":{"duration":3.276601,"end_time":"2024-08-08T06:08:48.402352","exception":false,"start_time":"2024-08-08T06:08:45.125751","status":"completed"},"tags":[]}},{"cell_type":"code","source":["df_2024['file_path'] = df_2024['isic_id'].apply(get_train_file_path)\n","df_2024 = df_2024[df_2024[\"file_path\"].isin(train_images) ].reset_index(drop=True)\n","df_2024"],"metadata":{"id":"r_2CKesDq0dL","papermill":{"duration":4.747528,"end_time":"2024-08-08T06:08:56.521196","exception":false,"start_time":"2024-08-08T06:08:51.773668","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/","height":964},"executionInfo":{"status":"ok","timestamp":1724454946839,"user_tz":-120,"elapsed":2808,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"fd6ec8f1-2c78-400c-cc16-77ba3244b7d9"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["             isic_id  target  patient_id  age_approx     sex  \\\n","0       ISIC_0015670       0  IP_1235828        60.0    male   \n","1       ISIC_0015845       0  IP_8170065        60.0    male   \n","2       ISIC_0015864       0  IP_6724798        60.0    male   \n","3       ISIC_0015902       0  IP_4111386        65.0    male   \n","4       ISIC_0024200       0  IP_8313778        55.0    male   \n","...              ...     ...         ...         ...     ...   \n","401054  ISIC_9999937       0  IP_1140263        70.0    male   \n","401055  ISIC_9999951       0  IP_5678181        60.0    male   \n","401056  ISIC_9999960       0  IP_0076153        65.0  female   \n","401057  ISIC_9999964       0  IP_5231513        30.0  female   \n","401058  ISIC_9999967       0  IP_6426047        50.0    male   \n","\n","       anatom_site_general  clin_size_long_diam_mm          image_type  \\\n","0          lower extremity                    3.04  TBP tile: close-up   \n","1                head/neck                    1.10  TBP tile: close-up   \n","2          posterior torso                    3.40  TBP tile: close-up   \n","3           anterior torso                    3.22  TBP tile: close-up   \n","4           anterior torso                    2.73  TBP tile: close-up   \n","...                    ...                     ...                 ...   \n","401054      anterior torso                    6.80  TBP tile: close-up   \n","401055     posterior torso                    3.11  TBP tile: close-up   \n","401056      anterior torso                    2.05  TBP tile: close-up   \n","401057      anterior torso                    2.80  TBP tile: close-up   \n","401058     lower extremity                    3.30  TBP tile: close-up   \n","\n","       tbp_tile_type   tbp_lv_A  ...  iddx_full  iddx_1  iddx_2  iddx_3  \\\n","0          3D: white  20.244422  ...     Benign  Benign     NaN     NaN   \n","1          3D: white  31.712570  ...     Benign  Benign     NaN     NaN   \n","2             3D: XP  22.575830  ...     Benign  Benign     NaN     NaN   \n","3             3D: XP  14.242329  ...     Benign  Benign     NaN     NaN   \n","4          3D: white  24.725520  ...     Benign  Benign     NaN     NaN   \n","...              ...        ...  ...        ...     ...     ...     ...   \n","401054        3D: XP  22.574335  ...     Benign  Benign     NaN     NaN   \n","401055     3D: white  19.977640  ...     Benign  Benign     NaN     NaN   \n","401056        3D: XP  17.332567  ...     Benign  Benign     NaN     NaN   \n","401057        3D: XP  22.288570  ...     Benign  Benign     NaN     NaN   \n","401058        3D: XP  16.792900  ...     Benign  Benign     NaN     NaN   \n","\n","        iddx_4  iddx_5  mel_mitotic_index  mel_thick_mm  \\\n","0          NaN     NaN                NaN           NaN   \n","1          NaN     NaN                NaN           NaN   \n","2          NaN     NaN                NaN           NaN   \n","3          NaN     NaN                NaN           NaN   \n","4          NaN     NaN                NaN           NaN   \n","...        ...     ...                ...           ...   \n","401054     NaN     NaN                NaN           NaN   \n","401055     NaN     NaN                NaN           NaN   \n","401056     NaN     NaN                NaN           NaN   \n","401057     NaN     NaN                NaN           NaN   \n","401058     NaN     NaN                NaN           NaN   \n","\n","        tbp_lv_dnn_lesion_confidence  \\\n","0                          97.517282   \n","1                           3.141455   \n","2                          99.804040   \n","3                          99.989998   \n","4                          70.442510   \n","...                              ...   \n","401054                     99.999988   \n","401055                     99.999820   \n","401056                     99.999416   \n","401057                    100.000000   \n","401058                     99.999960   \n","\n","                                                file_path  \n","0       /kaggle/input/isic-2024-challenge/train-image/...  \n","1       /kaggle/input/isic-2024-challenge/train-image/...  \n","2       /kaggle/input/isic-2024-challenge/train-image/...  \n","3       /kaggle/input/isic-2024-challenge/train-image/...  \n","4       /kaggle/input/isic-2024-challenge/train-image/...  \n","...                                                   ...  \n","401054  /kaggle/input/isic-2024-challenge/train-image/...  \n","401055  /kaggle/input/isic-2024-challenge/train-image/...  \n","401056  /kaggle/input/isic-2024-challenge/train-image/...  \n","401057  /kaggle/input/isic-2024-challenge/train-image/...  \n","401058  /kaggle/input/isic-2024-challenge/train-image/...  \n","\n","[401059 rows x 56 columns]"],"text/html":["\n","  <div id=\"df-8ce8bf48-605d-4145-baf5-077b57995577\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>isic_id</th>\n","      <th>target</th>\n","      <th>patient_id</th>\n","      <th>age_approx</th>\n","      <th>sex</th>\n","      <th>anatom_site_general</th>\n","      <th>clin_size_long_diam_mm</th>\n","      <th>image_type</th>\n","      <th>tbp_tile_type</th>\n","      <th>tbp_lv_A</th>\n","      <th>...</th>\n","      <th>iddx_full</th>\n","      <th>iddx_1</th>\n","      <th>iddx_2</th>\n","      <th>iddx_3</th>\n","      <th>iddx_4</th>\n","      <th>iddx_5</th>\n","      <th>mel_mitotic_index</th>\n","      <th>mel_thick_mm</th>\n","      <th>tbp_lv_dnn_lesion_confidence</th>\n","      <th>file_path</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ISIC_0015670</td>\n","      <td>0</td>\n","      <td>IP_1235828</td>\n","      <td>60.0</td>\n","      <td>male</td>\n","      <td>lower extremity</td>\n","      <td>3.04</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: white</td>\n","      <td>20.244422</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>97.517282</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ISIC_0015845</td>\n","      <td>0</td>\n","      <td>IP_8170065</td>\n","      <td>60.0</td>\n","      <td>male</td>\n","      <td>head/neck</td>\n","      <td>1.10</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: white</td>\n","      <td>31.712570</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>3.141455</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ISIC_0015864</td>\n","      <td>0</td>\n","      <td>IP_6724798</td>\n","      <td>60.0</td>\n","      <td>male</td>\n","      <td>posterior torso</td>\n","      <td>3.40</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>22.575830</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>99.804040</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ISIC_0015902</td>\n","      <td>0</td>\n","      <td>IP_4111386</td>\n","      <td>65.0</td>\n","      <td>male</td>\n","      <td>anterior torso</td>\n","      <td>3.22</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>14.242329</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>99.989998</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ISIC_0024200</td>\n","      <td>0</td>\n","      <td>IP_8313778</td>\n","      <td>55.0</td>\n","      <td>male</td>\n","      <td>anterior torso</td>\n","      <td>2.73</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: white</td>\n","      <td>24.725520</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>70.442510</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>401054</th>\n","      <td>ISIC_9999937</td>\n","      <td>0</td>\n","      <td>IP_1140263</td>\n","      <td>70.0</td>\n","      <td>male</td>\n","      <td>anterior torso</td>\n","      <td>6.80</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>22.574335</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>99.999988</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>401055</th>\n","      <td>ISIC_9999951</td>\n","      <td>0</td>\n","      <td>IP_5678181</td>\n","      <td>60.0</td>\n","      <td>male</td>\n","      <td>posterior torso</td>\n","      <td>3.11</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: white</td>\n","      <td>19.977640</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>99.999820</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>401056</th>\n","      <td>ISIC_9999960</td>\n","      <td>0</td>\n","      <td>IP_0076153</td>\n","      <td>65.0</td>\n","      <td>female</td>\n","      <td>anterior torso</td>\n","      <td>2.05</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>17.332567</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>99.999416</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>401057</th>\n","      <td>ISIC_9999964</td>\n","      <td>0</td>\n","      <td>IP_5231513</td>\n","      <td>30.0</td>\n","      <td>female</td>\n","      <td>anterior torso</td>\n","      <td>2.80</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>22.288570</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>100.000000</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","    <tr>\n","      <th>401058</th>\n","      <td>ISIC_9999967</td>\n","      <td>0</td>\n","      <td>IP_6426047</td>\n","      <td>50.0</td>\n","      <td>male</td>\n","      <td>lower extremity</td>\n","      <td>3.30</td>\n","      <td>TBP tile: close-up</td>\n","      <td>3D: XP</td>\n","      <td>16.792900</td>\n","      <td>...</td>\n","      <td>Benign</td>\n","      <td>Benign</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>99.999960</td>\n","      <td>/kaggle/input/isic-2024-challenge/train-image/...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>401059 rows × 56 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8ce8bf48-605d-4145-baf5-077b57995577')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-8ce8bf48-605d-4145-baf5-077b57995577 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-8ce8bf48-605d-4145-baf5-077b57995577');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-ec262e51-a378-4fd8-a563-d57dd62ea96c\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-ec262e51-a378-4fd8-a563-d57dd62ea96c')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-ec262e51-a378-4fd8-a563-d57dd62ea96c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","  <div id=\"id_d1f16fc9-19e8-46e0-b0a8-c435c381d4d7\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('df_2024')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_d1f16fc9-19e8-46e0-b0a8-c435c381d4d7 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('df_2024');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_2024"}},"metadata":{},"execution_count":59}]},{"cell_type":"code","source":["df_2024.to_csv(path_isic_data+\"df_2024_for prediction.csv\", index=False) # this is not usefull"],"metadata":{"papermill":{"duration":4.770597,"end_time":"2024-08-08T06:30:05.983588","exception":false,"start_time":"2024-08-08T06:30:01.212991","status":"completed"},"tags":[],"trusted":true,"id":"9CI3rNrWMQwp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_post_dataset = ISICDataset(df_2024, transforms=data_transforms[\"valid\"])\n","train_post_loader = DataLoader(train_post_dataset, batch_size=CONFIG['valid_batch_size'],\n","                          num_workers=2, shuffle=False, pin_memory=True)"],"metadata":{"papermill":{"duration":3.299116,"end_time":"2024-08-08T06:09:03.087075","exception":false,"start_time":"2024-08-08T06:08:59.787959","status":"completed"},"tags":[],"trusted":true,"id":"Pkjv1FTvMQwp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["preds_train = []\n","with torch.no_grad():\n","    bar = tqdm(enumerate(train_post_loader), total=len(train_post_loader))\n","    for step, data in bar:\n","        images = data['image'].to(CONFIG[\"device\"], dtype=torch.float)\n","        batch_size = images.size(0)\n","        outputs = model(images)\n","        preds_train.append( outputs.detach().cpu().numpy() )\n","preds_train = np.concatenate(preds_train).flatten()"],"metadata":{"id":"zoaBJPPY5tMZ","papermill":{"duration":1244.119438,"end_time":"2024-08-08T06:29:50.473085","exception":false,"start_time":"2024-08-08T06:09:06.353647","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724456890002,"user_tz":-120,"elapsed":1923290,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"c5071c05-2746-4346-9c88-823ce39e66b8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 6267/6267 [32:03<00:00,  3.26it/s]\n"]}]},{"cell_type":"code","source":["df_2024[\"preds\"] = preds_train\n"],"metadata":{"id":"wx53HJML5tMZ","papermill":{"duration":3.596489,"end_time":"2024-08-08T06:29:57.646601","exception":false,"start_time":"2024-08-08T06:29:54.050112","status":"completed"},"tags":[],"trusted":true},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["### df_2024.to_csv(\"my-mix-image-.csv\", index=False) # not used here and too large"],"metadata":{"papermill":{"duration":4.770597,"end_time":"2024-08-08T06:30:05.983588","exception":false,"start_time":"2024-08-08T06:30:01.212991","status":"completed"},"tags":[],"id":"swAmREoXMQwp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"-Gz4_1CjMQwq"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_2024[['isic_id', 'target', 'preds']].to_csv(path_isic_data+\"df_2024_after prediction.csv\", index=False)"],"metadata":{"papermill":{"duration":4.770597,"end_time":"2024-08-08T06:30:05.983588","exception":false,"start_time":"2024-08-08T06:30:01.212991","status":"completed"},"tags":[],"trusted":true,"id":"jsWvay5s49fy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model_loss = torch.load(path_isic_data+\"zinneke_picture\")\n","PATH = \"best_TRAIN_LOSS_model.bin\"\n","model_loss.load_state_dict(torch.load(PATH))\n","model_loss.eval()\n","torch.save(model_loss, path_isic_data+\"zinneke_picture_loss.pt\")"],"metadata":{"id":"vAo4UVa61Vab"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# INFERENCE 2024 TRAIN SPLIT BEST LOSS"],"metadata":{"papermill":{"duration":3.276601,"end_time":"2024-08-08T06:08:48.402352","exception":false,"start_time":"2024-08-08T06:08:45.125751","status":"completed"},"tags":[],"id":"qOHY1RdMKn3H"}},{"cell_type":"code","source":["model_loss = torch.load(path_isic_data+\"zinneke_picture\")\n","PATH = \"best_TRAIN_LOSS_model.bin\"\n","model_loss.load_state_dict(torch.load(PATH))\n","model_loss.eval()\n","torch.save(model_loss, path_isic_data+\"zinneke_picture_loss.pt\")"],"metadata":{"id":"YxIgN_VMKn3K"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_2024 = pd.read_csv(path_isic_data+\"df_2024_for prediction.csv\")"],"metadata":{"papermill":{"duration":4.770597,"end_time":"2024-08-08T06:30:05.983588","exception":false,"start_time":"2024-08-08T06:30:01.212991","status":"completed"},"tags":[],"trusted":true,"id":"bxTQgSTdKn3I"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_post_dataset = ISICDataset(df_2024, transforms=data_transforms[\"valid\"])\n","train_post_loader = DataLoader(train_post_dataset, batch_size=CONFIG['valid_batch_size'],\n","                          num_workers=2, shuffle=False, pin_memory=True)"],"metadata":{"papermill":{"duration":3.299116,"end_time":"2024-08-08T06:09:03.087075","exception":false,"start_time":"2024-08-08T06:08:59.787959","status":"completed"},"tags":[],"trusted":true,"id":"V5dp1PXPKn3J"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["preds_train = []\n","with torch.no_grad():\n","    bar = tqdm(enumerate(train_post_loader), total=len(train_post_loader))\n","    for step, data in bar:\n","        images = data['image'].to(CONFIG[\"device\"], dtype=torch.float)\n","        batch_size = images.size(0)\n","        outputs = model_loss(images)\n","        preds_train.append( outputs.detach().cpu().numpy() )\n","preds_train = np.concatenate(preds_train).flatten()"],"metadata":{"papermill":{"duration":1244.119438,"end_time":"2024-08-08T06:29:50.473085","exception":false,"start_time":"2024-08-08T06:09:06.353647","status":"completed"},"tags":[],"trusted":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"yi3Qd2XMKn3J","executionInfo":{"status":"ok","timestamp":1724458851947,"user_tz":-120,"elapsed":1951467,"user":{"displayName":"Pierre Decoodt","userId":"11089793044290653285"}},"outputId":"20b7c08b-ee24-43ff-c0cd-741d85be6e5d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 6267/6267 [32:31<00:00,  3.21it/s]\n"]}]},{"cell_type":"code","source":["df_2024[\"preds\"] = preds_train\n"],"metadata":{"papermill":{"duration":3.596489,"end_time":"2024-08-08T06:29:57.646601","exception":false,"start_time":"2024-08-08T06:29:54.050112","status":"completed"},"tags":[],"trusted":true,"id":"ZzjganrcKn3J"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["### df_2024.to_csv(\"my-mix-image-.csv\", index=False) # not used here and too large"],"metadata":{"papermill":{"duration":4.770597,"end_time":"2024-08-08T06:30:05.983588","exception":false,"start_time":"2024-08-08T06:30:01.212991","status":"completed"},"tags":[],"id":"pUL9NsECKn3J"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Esu11yA2Kn3K"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_2024[['isic_id', 'target', 'preds']].to_csv(path_isic_data+\"df_2024_after prediction best loss.csv\", index=False)"],"metadata":{"papermill":{"duration":4.770597,"end_time":"2024-08-08T06:30:05.983588","exception":false,"start_time":"2024-08-08T06:30:01.212991","status":"completed"},"tags":[],"trusted":true,"id":"DvZxjZOBKn3K"},"execution_count":null,"outputs":[]}]}